<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>MS Outlook Email VBO Extended V5</bpr:name>
    <bpr:release-notes />
    <bpr:created>2020-03-02 19:46:22Z</bpr:created>
    <bpr:package-id>-1</bpr:package-id>
    <bpr:package-name>&lt;Adhoc Package&gt;</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="1">
        <object id="5c60be74-477a-4372-8766-3c40de2354a5" name="MS Outlook Email VBO Extended" xmlns="http://www.blueprism.co.uk/product/process"><process name="MS Outlook Email VBO Extended" version="6.6.0.15260" bpversion="5.0.30.0" narrative="" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>ec75c4f1-6276-470b-b23f-9a88eb7a0f96</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>-128</camerax><cameray>-84</cameray><zoom version="2">1.25</zoom></view><preconditions><condition narrative="The Object requires a MS interop runtime DLL &quot;Microsoft.Office.Interop.Outlook.dll&quot; to be installed in order to run. This DLL can be installed as an optional feature using the Blue Prism installer." /></preconditions><endpoint narrative="" /><subsheet subsheetid="810b21b7-6b6b-4c7b-be10-b0c5f2911afc" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>-182</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e0b58522-643b-42ad-8fdd-4cb5246c5558" type="Normal" published="True"><name>Send Email</name><view><camerax>-98</camerax><cameray>49</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="8b7411f0-ef45-49d1-9995-b1f717d11fa6" type="Normal" published="True"><name>Save Email as PDF</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="78125029-0b28-4ee1-a064-c3a9e70ad7ca" type="Normal" published="True"><name>Reply All to Email</name><view><camerax>-25</camerax><cameray>71</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f6f16944-bdad-4ff4-a5df-b687b904183c" type="Normal" published="True"><name>Reply to Email</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9bf4e24d-5759-4357-97f1-adc1c08c843a" type="Normal" published="True"><name>Forward Email</name><view><camerax>-191</camerax><cameray>89</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="c153f5f7-2453-4b1c-810b-a866e8561be4" type="Normal" published="True"><name>Custom Reply</name><view><camerax>0</camerax><cameray>63</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2e6fb66c-9607-4731-829c-e3dfd4510a95" type="Normal" published="True"><name>Save Email As File</name><view><camerax>21</camerax><cameray>122</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7e173ed6-d754-4852-a127-5e593aa1aca2" type="Normal" published="True"><name>Forward Email (Custom Subject)</name><view><camerax>-191</camerax><cameray>89</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5734e4af-7917-40d8-b0b6-83d8e1872074" type="Normal" published="True"><name>Delete Email</name><view><camerax>-8</camerax><cameray>2</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="518068f5-ac12-4776-b94d-e5e24c7bd7a0" type="Normal" published="True"><name>Encode HTML as ASCII</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="204201c2-30d3-467a-b6fb-4e0010b046af" type="Normal" published="True"><name>Mark Email As Read</name><view><camerax>-8</camerax><cameray>2</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="c589c8f4-dd00-4bf1-a280-0344d74d0afb" type="Normal" published="True"><name>Get Contacts</name><view><camerax>0</camerax><cameray>70</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2d1820f0-98e4-4a10-8361-8f5322babcee" type="Normal" published="True"><name>Mark Email As Unread</name><view><camerax>-8</camerax><cameray>2</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="61b6fc18-b98a-4456-9381-8c8cfe9f6f60" type="Normal" published="True"><name>Move Email</name><view><camerax>-8</camerax><cameray>44</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="758f4938-75a1-4157-b0f7-2d9b99144d61" type="Normal" published="True"><name>Save Attachments</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f" type="Normal" published="True"><name>Save Attachment</name><view><camerax>20</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7aafcecd-5e8f-49d4-9987-73958f3cedc3" type="Normal" published="True"><name>Get Sent Items (Basic)</name><view><camerax>27</camerax><cameray>93</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d9c8a6c7-f973-45af-b333-8166a34297c7" type="Normal" published="True"><name>Get Sent Items (Advanced)</name><view><camerax>-26</camerax><cameray>-12</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="43fde12c-9d96-4cdd-a342-88204c037438" type="Normal" published="True"><name>Get Sent Items (Expert)</name><view><camerax>-42</camerax><cameray>46</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="a2bc0172-492f-4781-b7ed-1f1d550da3ba" type="Normal" published="True"><name>Get Received Items (Basic)</name><view><camerax>103</camerax><cameray>315</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f28aad59-a89a-4a9c-98ab-d31d6b69d9a5" type="Normal" published="True"><name>Get Received Items (Advanced)</name><view><camerax>-33</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4e4717e2-7dd0-4780-aa24-d21846d7b2a8" type="Normal" published="True"><name>Get Received Items (Customised)</name><view><camerax>103</camerax><cameray>294</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa" type="Normal" published="True"><name>Get Items Global (Basic)</name><view><camerax>103</camerax><cameray>273</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="df118776-808b-4c4e-a6d7-0281ffa4bb80" type="Normal" published="True"><name>Get Items Global (Advanced)</name><view><camerax>-33</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ea004198-e1fb-44bc-b549-bf8f7fa06631" type="Normal" published="True"><name>Get Received Items (Expert)</name><view><camerax>49</camerax><cameray>25</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="fb0dd28d-2875-4ec6-b6d5-475120ac222c" type="Normal" published="False"><name>Internal_Get Items</name><view><camerax>-91</camerax><cameray>46</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="5be4d12d-b679-4082-820f-35101beb093e" type="Normal" published="True"><name>Get Items Global (Expert)</name><view><camerax>49</camerax><cameray>25</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="e8eb24e1-c52b-45e6-80ba-9544055dab29" type="Normal" published="False"><name>Internal_Get Items - Customized</name><view><camerax>-91</camerax><cameray>46</cameray><zoom version="2">1.5625</zoom></view></subsheet><stage stageid="72d471a3-047f-457c-b72a-b8026ed0c984" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>2f4e925d-3b3b-4bbb-b2db-a1e713c23ee5</onsuccess></stage><stage stageid="2f4e925d-3b3b-4bbb-b2db-a1e713c23ee5" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="bf10fbf6-c2a1-4b51-9a5b-9919863cc24b" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><references><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>Microsoft.Office.Interop.Outlook.dll</reference><reference>Microsoft.Office.Interop.Word.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>Microsoft.VisualBasic</import><import>Microsoft.Win32</import><import>Microsoft.Office.Interop.Outlook</import><import>Microsoft.Office.Interop.Word</import><import>System.Text</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[Private Function GetStrippedMessage(ByVal msg As String) As String

Dim output As String = msg
Dim startIndex As Integer = 0
Dim endIndex As Integer = 0

While True
	endIndex = output.IndexOf("\plain", startIndex)
	If endIndex = -1 Then
		Exit While
	End If

	startIndex = endIndex

	Dim lastIndex As Integer = output.LastIndexOf(">", startIndex)
	If lastIndex <> -1 Then
		lastIndex += 1
		output = output.Remove(lastIndex, (startIndex - lastIndex) + 6)

		Dim temp As Integer = output.IndexOf("<", lastIndex)
		Dim tagHtml As String = output.Substring(lastIndex, temp - lastIndex)

		If tagHtml.Trim() = "" Then
			output = output.Insert(lastIndex, "&nbsp;")
		End If
	End If
End While
Return output
End Function

Private Function EncodeHTMLAsASCII(ByVal msg As String) As String
        Dim result = ""
        
        For i As Integer = 0 To msg.Length - 1
            Dim codePoint As Integer
			' ConvertToUtf32 will handle surrogate pairs.
			' But you can't point it at a Low Surrogate character - this
			' character will have already been handled when the High Surrogate Character
			' was processed.
			If Char.IsLowSurrogate(msg(i)) Then Continue For
            codePoint = Char.ConvertToUtf32(msg, i)
            
		'Encode any non-ASCII characters as HTML entities.
		' Unicode characters are encoded as '&#{codepoint};'
            If codePoint < 128
               result &= msg(i)
            Else
                result &= String.Format("&#{0};", codePoint.ToString())
            End If
        Next

        Return result
End Function]]></code></stage><stage stageid="0e25d23b-b518-4ba3-989e-4adf589c7dd3" name="Clean Up" type="SubSheetInfo"><subsheetid>810b21b7-6b6b-4c7b-be10-b0c5f2911afc</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="a9d4d214-a0e7-4383-8e44-7a4f068d71cd" name="Start" type="Start"><subsheetid>810b21b7-6b6b-4c7b-be10-b0c5f2911afc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>253513b1-e08e-49b0-a789-fb3659eeb650</onsuccess></stage><stage stageid="253513b1-e08e-49b0-a789-fb3659eeb650" name="End" type="End"><subsheetid>810b21b7-6b6b-4c7b-be10-b0c5f2911afc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="7d086243-ce98-49a9-8674-b8ca5349db4c" name="Note1" type="Note"><subsheetid>810b21b7-6b6b-4c7b-be10-b0c5f2911afc</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="8c3c4d09-dac0-411e-8e05-4db606c12164" name="Save Email As File" type="SubSheetInfo"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><narrative>Stores a specified email as a ".msg" file on any file location (file path).

The Entry ID is the unique idenfier used to determine which email is to be saved.</narrative><displayx>-195</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="2ff43150-6180-4cff-bf98-fd8d855bdbf9" name="Start" type="Start"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="File Path" narrative="Mandatory. The destination file path. Default blank." stage="File Path" /><input type="text" name="File Name" narrative="Mandatory. The File Name for the stored Email." stage="File Name" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>7287aac3-f380-41fd-99ed-1308db516359</onsuccess></stage><stage stageid="0ab2dc8d-39a7-4788-b7d2-7e6ff62b4cef" name="End" type="End"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="7287aac3-f380-41fd-99ed-1308db516359" name="Save As" type="Code"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><loginhibit /><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="File Path" expr="[File Path]" /><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="File Name" expr="[File Name]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>0ab2dc8d-39a7-4788-b7d2-7e6ff62b4cef</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
item.SaveAs (File_Path & File_Name & ".msg")]]></code></stage><stage stageid="0d8dbc79-fe44-41e3-a7a5-5b60b74fa2cf" name="File Path" type="Data"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="15416548-42aa-42e9-8a36-49d19e45e678" name="Internal_Get Items" type="SubSheetInfo"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative>Sub function used by multiple actions within VBO. Do not change or publish.

Uses the Restrict method to create a filtered list of folder items. Not intended for publication.

</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="a6573dfb-b844-470c-bfe7-73c863da28d4" name="Start" type="Start"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" stage="Filter Expression" /><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" stage="Outlook Folder ID" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." stage="Sub Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>d9ef3bca-bf49-4f84-9d4c-b3648951f323</onsuccess></stage><stage stageid="26935ec9-3f33-4a4d-982c-0e6b0a5edbc2" name="End" type="End"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="d9ef3bca-bf49-4f84-9d4c-b3648951f323" name="Get Items" type="Code"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" expr="[Filter Expression]" /><input type="number" name="Outlook Folder ID" expr="[Outlook Folder ID]" /><input type="text" name="Sub Folder" expr="[Sub Folder]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" stage="Items" /><output type="number" name="Item Count" stage="Item Count" /></outputs><onsuccess>26935ec9-3f33-4a4d-982c-0e6b0a5edbc2</onsuccess><code><![CDATA[
Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)

Dim folder = _nameSpace.GetDefaultFolder(6)
If Outlook_Folder_ID = "-1" Then
	folder = folder.Parent
Else
	folder = _nameSpace.GetDefaultFolder(Outlook_Folder_ID)
End If

If Sub_Folder <> "" Then
	For each name as string in Sub_Folder.Split("\")
	folder = folder.Folders(name)
	Next
End If

'See https://msdn.microsoft.com/en-us/library/office/aa210946(v=office.11).aspx
'for mail item properties
Dim dataTable As New Data.DataTable
dataTable.Columns.Add("EntryID", Type.GetType("System.String"))
dataTable.Columns.Add("To", Type.GetType("System.String"))
dataTable.Columns.Add("CC", Type.GetType("System.String"))
dataTable.Columns.Add("Subject", Type.GetType("System.String"))
dataTable.Columns.Add("Body", Type.GetType("System.String"))
dataTable.Columns.Add("Attachments", Type.GetType("System.String"))
dataTable.Columns.Add("ReceivedOn", Type.GetType("System.DateTime"))
dataTable.Columns.Add("SentOn", Type.GetType("System.DateTime"))
dataTable.Columns.Add("SenderName", Type.GetType("System.String"))
dataTable.Columns.Add("SenderEmailAddress", Type.GetType("System.String"))
dataTable.Columns.Add("Unread", Type.GetType("System.Boolean"))

Dim folderItems = If(Filter_Expression <> "", folder.Items.Restrict(Filter_Expression), folder.Items)

For Each item As Object In folderItems
	If Not TypeOf item Is MailItem Then Continue For
	Dim row As Data.DataRow = dataTable.NewRow
	row("EntryID") = item.EntryID
	row("To") = item.To
	row("CC") = item.CC
	row("Subject") = item.Subject
	row("Body") = item.Body
	
	Dim attachments As String = ""
	For Each attachment As Object In item.Attachments
        If attachment.Type = 1 Then
			attachments = attachments & "|" & attachment.DisplayName
		End If
	Next
	
	row("Attachments") = If (attachments.Length = 0, "", attachments.SubString(1))
	row("SentOn") = item.SentOn
	row("ReceivedOn") = item.ReceivedTime
	row("SenderName") = item.SenderName
	row("SenderEmailAddress") = If (item.SenderEmailType = "EX",item.Sender.GetExchangeUser.PrimarySmtpAddress,item.SenderEmailAddress)
	row("Unread") = item.Unread
	dataTable.Rows.Add(row)
	Item_Count += 1
Next
Items = dataTable]]></code></stage><stage stageid="301b8904-3bcd-4b1b-805a-0a190d6a1f23" name="Item Count" type="Data"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="563eaaf3-d093-48a1-89fe-5b6dcc312f81" name="Filter Expression" type="Data"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d314f7c0-0af6-4cc5-a2e1-1b2cb29674d9" name="Entry ID" type="Data"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5106a0ab-6cbb-410f-9e0d-113791019ded" name="Get Received Items (Advanced)" type="SubSheetInfo"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative>Lists Inbox items matching the filter provided

Eg1 [From]='Mike Coworker' AND [unread]=False

Eg2 [Unread]=True AND [ReceivedTime] &gt;= '2018/01/01'

See https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="38a5b9e1-f5ae-4293-96b5-8e39f6ddad5f" name="Start" type="Start"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" stage="Filter Expression" /><input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." stage="Sub Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>bb657ac6-ea98-4042-8df8-0bfec4fe5f42</onsuccess></stage><stage stageid="88b1aeeb-8765-4f0c-98b3-a64aa3effa2c" name="Item Count" type="Data"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e9952465-1c95-422d-9bfe-1735745d3012" name="Filter Expression" type="Data"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4d97db59-defd-4f2b-80a0-50ae2c87c68e" name="Outlook Folder ID" type="Data"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="bb657ac6-ea98-4042-8df8-0bfec4fe5f42" name="Internal_Get Items" type="SubSheet"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Sub Folder]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>87fa8e80-f1f1-4329-8256-0224c2a2164c</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="036baecd-65dc-4916-9438-165b479478b1" name="Outlook Folder ID" type="Data"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="7c584784-b258-4700-ae02-482668348ae9" name="Get Sent Items (Expert)" type="SubSheetInfo"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><narrative>Lists Sent Items matching the query provided.

Eg1 @SQL=urn:schemas:httpmail:subject='Data Input'

Eg2 @SQL=urn:schemas:httpmail:displayto='Mike Colleague' AND (urn:schemas:httpmail:subject LIKE '%Important%' OR urn:schemas:httpmail:subject LIKE '%Urgent%')"

See https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="ecc59d78-3d95-4f68-8f6d-7dfa2ad7c6d4" name="Start" type="Start"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="DASL Query" narrative="Mandatory. A filter using a DASL query, eg @SQL=urn:schemas:httpmail:displayto='Mike Colleague' AND (urn:schemas:httpmail:subject LIKE '%Important%' OR urn:schemas:httpmail:subject LIKE '%Urgent%')" stage="Filter Expression" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>ef7b49fa-9e40-4ce5-b6ac-67e5c3171164</onsuccess></stage><stage stageid="68c67a7a-d81f-4def-823b-761b317fc9f5" name="Item Count" type="Data"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="78a90b2a-607e-4d8d-8f04-7c3a81e8bf63" name="Filter Expression" type="Data"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="920c79f3-90b3-487b-a30c-4e95162d5ecb" name="Outlook Folder ID" type="Data"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>5</initialvalue><private /><alwaysinit /></stage><stage stageid="ef7b49fa-9e40-4ce5-b6ac-67e5c3171164" name="Internal_Get Items" type="SubSheet"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="&quot;&quot;" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>88475529-0d3e-40b9-8ead-79cedfbdf8c6</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="89de27c3-f759-42a1-956d-49dc91baa367" name="Send Email" type="SubSheetInfo"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><narrative>Sends an Email </narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="2f285e28-d6bb-4e7b-be7b-2631c3a8ac84" name="End" type="End"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="79296089-edc5-4338-bf95-6734ad47825d" name="Send Item" type="Code"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="To" expr="[To]" /><input type="text" name="CC" expr="[CC]" /><input type="text" name="BCC" expr="[BCC]" /><input type="text" name="Subject" expr="[Subject]" /><input type="text" name="Message" expr="[Message]" /><input type="text" name="Attachments" expr="[Attachments]" /><input type="flag" name="Message Is HTML" expr="[Message Is HTML]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>2f285e28-d6bb-4e7b-be7b-2631c3a8ac84</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim mail = app.CreateItem(0)
Dim addressCount As Integer

If [To] <> "" Then
	Dim toAddresses = Split([To], ";")
	For addressCount = LBound(toAddresses) To UBound(toAddresses)
	Dim recipient = mail.Recipients.Add(toAddresses(addressCount)) 
	recipient.Resolve  
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olTo
	Next 
	
End if

If CC <> "" Then
	Dim ccAddresses = Split([CC], ";")
	addressCount = 0
	For addressCount = LBound(ccAddresses) To UBound(ccAddresses)
	Dim recipient = mail.Recipients.Add(ccAddresses(addressCount))
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olCC 
	Next

End If

If BCC <> "" Then
	Dim bccAddresses = Split([BCC], ";")
	addressCount = 0
	For addressCount = LBound(bccAddresses) To UBound(bccAddresses)
	Dim recipient = mail.Recipients.Add(bccAddresses(addressCount))
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olBCC
	Next

End If

mail.Subject = Subject
mail.HTMLBody = Message

For Each att As String In Attachments.Split(";"c)
	If att = "" Then Continue For
	mail.Attachments.Add(att)
Next

mail.Save
mail.Send

_nameSpace.Logoff()]]></code></stage><stage stageid="e8e74832-24e7-4d9b-977d-f3720a5f58a3" name="Subject" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9254c70d-8233-413f-a7c8-5b920c8d7595" name="To" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8c4cefa2-e465-4d3a-adae-410a8e2d6b73" name="Message" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3106293e-e64d-4d13-9671-b39e8c6be771" name="Attachments" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9418ede2-db6d-4912-bcd8-209a495359dc" name="Save Attachments" type="SubSheetInfo"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><narrative>Downloads all attachments to a folder. 

The Entry ID is the unique idenfier used to determine which email is to be actioned.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f3f87040-02dc-44e3-94ac-4e94444ce722" name="End" type="End"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="2e36171f-a7a2-4de1-b778-bd029753aad5" name="Start" type="Start"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." stage="Folder Path" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>0ec3c501-009c-4736-9511-3b84c98dcc66</onsuccess></stage><stage stageid="0ec3c501-009c-4736-9511-3b84c98dcc66" name="Save Attachments" type="Code"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Folder Path" expr="[Folder Path]" /><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="File Pattern" expr="[File Pattern]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>f3f87040-02dc-44e3-94ac-4e94444ce722</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
If item Is Nothing Then Return

If Not Folder_Path.EndsWith("\") Then Folder_Path &="\"

For Each attachment As Object In item.Attachments
	If (attachment.Type = 1 OrElse attachment.Type = 5) AndAlso attachment.FileName Like File_Pattern Then
		attachment.SaveAsFile(Folder_Path & attachment.FileName)
	End If
Next
]]></code></stage><stage stageid="38d69990-6a5f-40ce-a4bb-541e49726b64" name="Folder Path" type="Data"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9f357ec6-15f4-4133-8da8-5061d4359d38" name="Entry ID" type="Data"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6a88d805-9f51-4298-9905-cb28610dae96" name="File Pattern" type="Data"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">*.*</initialvalue><private /><alwaysinit /></stage><stage stageid="ad2e31ff-e5ef-4467-a348-13dc9a8a1acb" name="Save Attachment" type="SubSheetInfo"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><narrative>Downloads a specfic attachment to a folder. E.g. use cases are "*.txt" or "*.docx" etc.

The Entry ID is the unique idenfier used to determine which email is to be actioned.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="a8e9b1e1-4b0f-487d-89a5-6cacb4092be4" name="End" type="End"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="2d1786e1-24e4-45da-b52c-bffa330fb007" name="Start" type="Start"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." stage="Folder Path" /><input type="text" name="File Name" narrative="Optional, Default value is *.* but common cases inlcude &quot;.docx&quot; , &quot;.pdf&quot; , &quot;.xlsx&quot; etc." stage="File Name" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>b1663b58-d99f-4f8e-9641-4b3db50ca615</onsuccess></stage><stage stageid="d2e8f631-485a-489a-8cbc-aac247d721f9" name="Folder Path" type="Data"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d7649073-c4eb-42b1-aaa4-7c50430a5cf3" name="Entry ID" type="Data"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9b7a4371-4fa0-4a3e-a132-5315118f7cae" name="File Name" type="Data"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="16e667f4-007c-48aa-91ad-4f253b96fc00" name="CC" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bc158b15-69a9-4850-a4e2-d67f53c55d87" name="BCC" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="983656a5-d686-4ef0-ab54-aa50aa32e7d5" name="Delete Email" type="SubSheetInfo"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><narrative>Deletes a specific email item.

The Entry ID is the unique idenfier used to determine which email is to be deleted.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="5f395532-0166-41e3-9087-6eb241347133" name="Start" type="Start"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>29bbbced-f689-4200-b43b-27e7b01a3c5d</onsuccess></stage><stage stageid="a191ef9e-e78a-4de9-901b-19e7ca766c72" name="End" type="End"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="29bbbced-f689-4200-b43b-27e7b01a3c5d" name="Delete" type="Code"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><loginhibit /><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>a191ef9e-e78a-4de9-901b-19e7ca766c72</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
item.Delete]]></code></stage><stage stageid="2d8d8f32-8e9d-49fc-a345-a25e3050ecac" name="Entry ID" type="Data"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a1dcba3a-0e74-4632-809f-7b942c719eeb" name="Reply All to Email" type="SubSheetInfo"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><narrative>Reply to all Emails recipients of a specific email.

The &lt;Reply All to Email&gt; action will only call one ID specific (Entry ID) email item. 

If multiple emails are expected to be called, the process design would need to reflect that requirement.</narrative><displayx>-195</displayx><displayy>-60</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="91e5fe6f-95fe-4c43-aac6-317ccb565fa8" name="End" type="End"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="719856cc-820a-4771-b362-9f0d98896f7b" name="Start" type="Start"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." stage="Message" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /><input type="text" name="Attachments" narrative="Optional, Semi-Colon-separated file paths. Default blank." stage="Attachments" /></inputs><onsuccess>a5f3fe96-39cd-4d2f-ad7f-a03fe9295f96</onsuccess></stage><stage stageid="a5f3fe96-39cd-4d2f-ad7f-a03fe9295f96" name="Reply All" type="Code"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><loginhibit /><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Message" expr="[Message]" /><input type="text" name="Profile" expr="[Profile]" /><input type="text" name="Attachments" expr="[Attachments]" /></inputs><onsuccess>91e5fe6f-95fe-4c43-aac6-317ccb565fa8</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)

Dim item = _nameSpace.GetItemFromID(Entry_ID)
Dim reply = item.ReplyAll

reply.Subject = item.Subject

Dim sr As StringBuilder = New StringBuilder()
sr.Append("<HR>").Append("<P style='font-size: 11pt; font-family: Calibri'>").Append("<B>From:</B> " & item.SenderEmailAddress).Append("<BR><B>Sent:</B> " & item.SentOn.ToString()).Append("<BR><B>To:</B> " & item.To)

Dim ccAddrs As String = item.CC
If ccAddrs.Length > 0 Then
	sr.Append("<BR><B>CC:</B> " & ccAddrs)
End If

sr.Append("<BR><B>Subject:</B> " & item.Subject).Append("</P>").Append("<BR><BR>")

reply.HTMLBody = Message & sr.ToString() & item.HTMLBody


For Each att As String In Attachments.Split(";"c)
	If att = "" Then Continue For
	reply.Attachments.Add(att)
Next

reply.Send]]></code></stage><stage stageid="c0de4880-e914-4cbd-9b40-fd4b87639b56" name="Entry ID" type="Data"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4aa3eccc-d10e-460b-96ce-82f3d86a5c36" name="Message" type="Data"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="502b5d9b-0ef4-4f7d-9e45-2740f2866f3a" name="Forward Email" type="SubSheetInfo"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><narrative>Forward Email to recipients (To/CC/BCC) including (Message) as input parameters.

The &lt;Forward Email&gt; action will only call one ID specific (Entry ID) email item. 

If multiple emails are expected to be called, the process design would need to reflect that requirement.</narrative><displayx>-195</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="d398f6bf-9903-432b-9d08-93ca68a5ce15" name="End" type="End"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="b5542c2e-3ef3-4636-82e6-10fcb6b9f5ef" name="Entry ID" type="Data"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bd6ecc76-eb50-4203-95cd-c77e9fcf2ad5" name="Message" type="Data"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9886ff21-e65d-440d-b60a-9869153650be" name="Forward" type="Code"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="To" expr="[To]" /><input type="text" name="CC" expr="[CC]" /><input type="text" name="BCC" expr="[BCC]" /><input type="text" name="Message" expr="[Message]" /><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>d398f6bf-9903-432b-9d08-93ca68a5ce15</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
Dim mail = item.Forward
Dim addressCount As Integer

If [To] <> "" Then
	Dim toAddresses = Split([To], ";")
	For addressCount = LBound(toAddresses) To UBound(toAddresses)
	Dim recipient = mail.Recipients.Add(toAddresses(addressCount)) 
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olTo
	Next

End If

If CC <> "" Then
	Dim ccAddresses = Split([CC], ";")
	addressCount = 0
	For addressCount = LBound(ccAddresses) To UBound(ccAddresses)
	Dim recipient = mail.Recipients.Add(ccAddresses(addressCount))
	recipient.Resolve	
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olCC
	Next

End If
	
If BCC <> "" Then
	Dim bccAddresses = Split([BCC], ";")
	addressCount = 0
	For addressCount = LBound(bccAddresses) To UBound(bccAddresses)
	Dim recipient = mail.Recipients.Add(bccAddresses(addressCount))
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olBCC
	Next

End If

mail.HTMLBody = Message & vbCrLf & mail.HTMLBody
mail.Save
mail.Send]]></code></stage><stage stageid="9a9158e0-2caf-4e8b-8277-bcfa3f0b8565" name="To" type="Data"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fba137b6-ad3b-48a5-b887-6302a10956ec" name="CC" type="Data"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d683ac76-a352-4994-89a5-d8a249f84648" name="BCC" type="Data"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5ed52409-4c74-4cd4-8b16-9e9d057097b4" name="Start" type="Start"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" stage="To" /><input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="CC" /><input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="BCC" /><input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." stage="Message" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>9886ff21-e65d-440d-b60a-9869153650be</onsuccess></stage><stage stageid="276590e9-5fa1-42bb-8bb0-3640cd595e46" name="Message Is HTML" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="c36190da-7569-4737-a401-bec5b006c53f" name="Start" type="Start"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" stage="To" /><input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="CC" /><input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="BCC" /><input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." stage="Subject" /><input type="text" name="Message" narrative="Optional, HTML or plain text" stage="Message" /><input type="text" name="Attachments" narrative="Optional, Semi-Colon-separated file paths. Default blank." stage="Attachments" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>79296089-edc5-4338-bf95-6734ad47825d</onsuccess></stage><stage stageid="6e74a6d0-d073-418d-bcee-5efe9f5733bb" name="Sub Folder" type="Data"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="df4f0bad-ced5-4315-8edc-e3138d7a7123" name="Sub Folder" type="Data"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="80516df7-3359-4f2c-8547-9312e5b237c2" name="Items" type="Collection"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="88475529-0d3e-40b9-8ead-79cedfbdf8c6" name="End" type="End"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="87fa8e80-f1f1-4329-8256-0224c2a2164c" name="End" type="End"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="93f4c073-8a54-4ee0-9b01-776c516fec9d" name="Reply to Email" type="SubSheetInfo"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><narrative>Reply to Email sender of a specific email.

The &lt;Reply to Email&gt; action will only call one ID specific (Entry ID) email item. 

If multiple emails are expected to be called, the process design would need to reflect that requirement.</narrative><displayx>-165</displayx><displayy>-60</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="7273229e-a2d0-4468-a343-efaf656b1598" name="End" type="End"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f68ab080-2e34-44d9-93af-67409139a21d" name="Start" type="Start"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." stage="Message" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /><input type="text" name="Attachments" narrative="Optional, Semi-Colon-separated file paths. Default blank." stage="Attachments" /></inputs><onsuccess>52a97793-74c5-49d7-b4fc-55d03d5b81a2</onsuccess></stage><stage stageid="52a97793-74c5-49d7-b4fc-55d03d5b81a2" name="Reply" type="Code"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><loginhibit /><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Message" expr="[Message]" /><input type="text" name="Profile" expr="[Profile]" /><input type="text" name="Attachments" expr="[Attachments]" /></inputs><onsuccess>7273229e-a2d0-4468-a343-efaf656b1598</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
Dim reply = item.Reply

reply.Subject = item.Subject

Dim sr As StringBuilder = New StringBuilder()
sr.Append("<HR>").Append("<P style='font-size: 11pt; font-family: Calibri'>").Append("<B>From:</B> " & item.SenderEmailAddress).Append("<BR><B>Sent:</B> " & item.SentOn.ToString()).Append("<BR><B>To:</B> " & item.To)

Dim ccAddrs As String = item.CC
If ccAddrs.Length > 0 Then
	sr.Append("<BR><B>CC:</B> " & ccAddrs)
End If

sr.Append("<BR><B>Subject:</B> " & item.Subject).Append("</P>").Append("<BR><BR>")

reply.HTMLBody = Message & sr.ToString() & item.HTMLBody

For Each att As String In Attachments.Split(";"c)
	If att = "" Then Continue For
	reply.Attachments.Add(att)
Next

reply.Send
]]></code></stage><stage stageid="b129ab89-df26-4975-a3b1-30127f6e78af" name="Entry ID" type="Data"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-165</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="34d6dbc0-3597-4b72-8a65-5a90f164b75a" name="Message" type="Data"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="da3ecbf5-d75b-47d2-90f4-fa09e80b656b" name="Move Email" type="SubSheetInfo"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><narrative>Moves an email to a subfolder within the inbox folder.

The Entry ID is the unique idenfier used to determine which email is to be moved.

Example
Inbox to Inbox\SubFolder </narrative><displayx>-180</displayx><displayy>-60</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="9033fc52-da65-4e8d-92a5-b67a33a0379a" name="Start" type="Start"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Destination Folder" narrative="Mandatory. Any alphanumeric value valid. The Subfolder in the root folder, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Inbox, needs to be declared as &quot;Inbox\Subfolder B&quot;." stage="Destination Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>3fa82add-9fd2-4264-8fbe-02536dae2237</onsuccess></stage><stage stageid="5461bd38-d7d7-4a3c-b23b-35857aa8a5ef" name="End" type="End"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="text" name="New Entry ID" narrative="Returns the new Entry ID from the Moved Email Object" stage="New Entry ID" /></outputs></stage><stage stageid="3fa82add-9fd2-4264-8fbe-02536dae2237" name="Move" type="Code"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><loginhibit /><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Destination Folder" expr="[Destination Folder]" /><input type="text" name="Outlook Folder ID" expr="[Outlook Folder ID]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="text" name="New Entry ID" stage="New Entry ID" /></outputs><onsuccess>5461bd38-d7d7-4a3c-b23b-35857aa8a5ef</onsuccess><code><![CDATA[New_Entry_ID = ""
Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)

Dim folder = _nameSpace.GetDefaultFolder(Outlook_Folder_ID).Parent
Dim item = _nameSpace.GetItemFromID(Entry_ID)

If Destination_Folder <> "" Then
	For each name as string in Destination_Folder.Split("\")
	folder = folder.Folders(name)
	Next
	New_Entry_ID = item.Move(folder).EntryID
End If
]]></code></stage><stage stageid="18da11cb-f313-4820-b7e7-8c9bd6f12675" name="Entry ID" type="Data"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-180</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="41304024-3f20-476e-b6bf-1e12ff6ead9a" name="Outlook Folder ID" type="Data"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><narrative>MS Outlook - OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-180</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="9d9afabb-e65b-471a-8a66-913480436037" name="Destination Folder" type="Data"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="aa9964be-3e71-4206-88f6-74e09c1f1415" name="File Name" type="Data"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="30cb5e90-86c2-4790-9204-89ddbd70d778" name="Get Sent Items (Basic)" type="SubSheetInfo"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative>Lists Sent Items matching the parameters provided</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="b4070f66-8405-4c2f-87f1-4d34a75561b8" name="Start" type="Start"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Sent To" narrative="Optional. The To display name, which might be a name (eg John Smith), an email address (eg admin@client.com), or a list (eg John Smith; Ann Jones; admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the To field." stage="Sent To" /><input type="text" name="Copied To" narrative="Optional. The CC display name, which might be a name (eg John Smith), an email address (eg admin@client.com), or a semi-colon separated list (eg John Smith; Ann Jones; admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the To field." stage="Copied To" /><input type="datetime" name="Sent Earliest" narrative="Optional. The earliest date to search from." stage="Sent Earliest" /><input type="datetime" name="Sent Latest" narrative="Optional. The latest date to search to." stage="Sent Latest" /><input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." stage="Subject" /><input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" stage="Message" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>69a5f33d-acd2-4bb9-9d2b-069cfc7fc32c</onsuccess></stage><stage stageid="905b5da3-5ab3-4c57-8c5f-33ed85e5c4a8" name="Item Count" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="97127f0f-f77c-4b85-9c18-18e6556fbfa4" name="Outlook Folder ID" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>5</initialvalue><private /><alwaysinit /></stage><stage stageid="5097438d-04b5-4688-9fd5-c93dbe0d26c4" name="Internal_Get Items" type="SubSheet"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>285</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="&quot;&quot;" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>20b10fc6-ced8-4cf1-b991-19fbff8e181a</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="20b10fc6-ced8-4cf1-b991-19fbff8e181a" name="End" type="End"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>345</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="2fc294dd-0be1-48ae-85b7-f811d7015b19" name="Filter Expression" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="29639c3b-dcc7-4427-bc90-57319d2ae6e8" name="Sent Earliest" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>225</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="28d1cc10-ae57-4ea2-b01c-b9a8bded12ad" name="Sent Latest" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>225</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a3d2888f-df21-47e3-8405-7f6f4564a71b" name="Clean" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5097438d-04b5-4688-9fd5-c93dbe0d26c4</onsuccess><calculation expression="&quot;@SQL=&quot;&amp;Trim(Mid([Filter Expression], 6, Len([Filter Expression])))" stage="Filter Expression" /></stage><stage stageid="b1ccbeb8-4c66-4932-a81f-c8c55c156731" name="Copied To" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>225</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="67f7a5fe-f2d5-480e-be1c-6a18d5a79508" name="Sent To" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>225</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8c54a3bb-1c08-4f3e-9ab2-3ceae0478554" name="Get Received Items (Basic)" type="SubSheetInfo"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative>Lists Inbox items matching the parameters provided</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="b5946711-b185-44bd-b97e-cfe91f9b05a2" name="Item Count" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>270</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="32bea08c-862f-440c-bc83-c05ca252286c" name="Internal_Get Items" type="SubSheet"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>420</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Sub Folder]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>717dbab6-6472-4f2d-9370-0ae2d5893829</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="cc00500b-17df-437f-816e-59bd2b9b6a11" name="Outlook Folder ID" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="0a3d1d6c-696a-4e50-a124-af43552a1c59" name="Sub Folder" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="717dbab6-6472-4f2d-9370-0ae2d5893829" name="End" type="End"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>480</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="fa7fc102-6824-4d83-9171-9b36913fb323" name="Subject" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>240</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0149c9d2-5846-4f23-8eb9-e639be1f7435" name="Start" type="Start"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Sender Name" narrative="Optional. The From display name, which might be a name (eg John Smith) or email address (eg admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the From field." stage="Sender Name" /><input type="text" name="Sender Email" narrative="Optional. The sender email address." stage="Sender Email" /><input type="datetime" name="Received Earliest" narrative="Optional. The earliest date to search from." stage="Received Earliest" /><input type="datetime" name="Received Latest" narrative="Optional. The latest date to search to." stage="Received Latest" /><input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." stage="Subject" /><input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" stage="Message" /><input type="flag" name="Include Read" narrative="Optional, default True" stage="Include Read" /><input type="flag" name="Include Unread" narrative="Optional, default True" stage="Include Unread" /><input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." stage="Sub Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>6b969896-5d1a-4f3c-9112-66df0d584150</onsuccess></stage><stage stageid="9d18dd85-49e7-4434-b66e-2f6bdedb4dad" name="Received Earliest" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>240</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d3fc67bd-0f5c-4d13-bb51-0b378401d726" name="Received Latest" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>240</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f180ecf8-78fc-4b37-8a12-69b310abf874" name="Filter Expression" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6b969896-5d1a-4f3c-9112-66df0d584150" name="Sender Name?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sender Name]&lt;&gt;&quot;&quot;" /><ontrue>1eaeb40e-7ba5-4437-86fb-8490d10d7e99</ontrue><onfalse>4b48c6b0-a2af-431b-ab0d-d43ee5ebfd20</onfalse></stage><stage stageid="1eaeb40e-7ba5-4437-86fb-8490d10d7e99" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4b48c6b0-a2af-431b-ab0d-d43ee5ebfd20</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:sendername LIKE '&quot;&amp;Replace([Sender Name], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="cf1214bb-b7fd-4fec-ab0b-dde176bcca9a" name="Clean Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>330</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>2bc9f050-ac4b-4e53-833b-77f8fd75e0ab</onsuccess><calculation expression="Trim(Mid([Filter Expression], 6, Len([Filter Expression])))" stage="Filter Expression" /></stage><stage stageid="0a1a6586-94ea-4da3-a8af-cb1ea4a13659" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>f24225cb-32e2-4f31-b9f8-f75390a670a9</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:subject LIKE '&quot;&amp;Replace([Subject], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="747ae4c1-94e5-4288-a0cf-573663610ed9" name="Subject?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Subject]&lt;&gt;&quot;&quot;" /><ontrue>0a1a6586-94ea-4da3-a8af-cb1ea4a13659</ontrue><onfalse>f24225cb-32e2-4f31-b9f8-f75390a670a9</onfalse></stage><stage stageid="4b48c6b0-a2af-431b-ab0d-d43ee5ebfd20" name="Sender Email?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sender Email]&lt;&gt;&quot;&quot;" /><ontrue>9153efb4-8f18-48c4-9833-9f3364eeea6a</ontrue><onfalse>747ae4c1-94e5-4288-a0cf-573663610ed9</onfalse></stage><stage stageid="9153efb4-8f18-48c4-9833-9f3364eeea6a" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>747ae4c1-94e5-4288-a0cf-573663610ed9</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:senderemail LIKE '&quot;&amp;Replace([Sender Email], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="a72f4464-acf3-4e70-825d-a0ae628fb772" name="Sender Name" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>240</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="da4b8732-2d70-4ad2-8757-603e1aa7d769" name="Sender Email" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>240</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2bc9f050-ac4b-4e53-833b-77f8fd75e0ab" name="Filter Expression?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Filter Expression]&lt;&gt;&quot;&quot;" /><ontrue>cf067e4c-9a82-41b9-acb9-9643cb195100</ontrue><onfalse>32bea08c-862f-440c-bc83-c05ca252286c</onfalse></stage><stage stageid="cf067e4c-9a82-41b9-acb9-9643cb195100" name="Prepend" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>32bea08c-862f-440c-bc83-c05ca252286c</onsuccess><calculation expression="&quot;@SQL=&quot;&amp;[Filter Expression]" stage="Filter Expression" /></stage><stage stageid="b7a34496-b13f-4bf8-a6ed-b14f0dbbfdb9" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>cf1214bb-b7fd-4fec-ab0b-dde176bcca9a</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:read=0&quot;" stage="Filter Expression" /></stage><stage stageid="e3df62cc-bf1a-4ea1-8c56-de279ca09c6b" name="Sent To?" type="Decision"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sent To]&lt;&gt;&quot;&quot;" /><ontrue>efe53d68-d29a-4388-afbd-b2866cb03c87</ontrue><onfalse>4cc56a65-c57b-4daa-86ed-8033d486e7b9</onfalse></stage><stage stageid="efe53d68-d29a-4388-afbd-b2866cb03c87" name="Filter Expression" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4cc56a65-c57b-4daa-86ed-8033d486e7b9</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:displayto LIKE '&quot;&amp;Replace([Sent To], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="3ac23120-2c22-4fc7-b0ef-bbbc45a030b1" name="Filter Expression" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>ba79bc8b-8091-4327-b1b2-3c6ccfb3f51b</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:subject LIKE '&quot;&amp;Replace([Subject], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="4df1ab8f-9b5e-4224-976f-67c1073cabfb" name="Subject?" type="Decision"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Subject]&lt;&gt;&quot;&quot;" /><ontrue>3ac23120-2c22-4fc7-b0ef-bbbc45a030b1</ontrue><onfalse>ba79bc8b-8091-4327-b1b2-3c6ccfb3f51b</onfalse></stage><stage stageid="4cc56a65-c57b-4daa-86ed-8033d486e7b9" name="Copied To?" type="Decision"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Copied To]&lt;&gt;&quot;&quot;" /><ontrue>9533d2e4-6aa7-4fd8-84aa-328875bd17d3</ontrue><onfalse>4df1ab8f-9b5e-4224-976f-67c1073cabfb</onfalse></stage><stage stageid="9533d2e4-6aa7-4fd8-84aa-328875bd17d3" name="Filter Expression" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4df1ab8f-9b5e-4224-976f-67c1073cabfb</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:displaycc LIKE '&quot;&amp;Replace([Copied To], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="c0a30ff4-3c4e-4a4b-81bc-22fad4bfb5e4" name="Filter Expression" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>e42900f2-2408-444c-b8c0-7077cfc7ab63</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&gt;='&quot; &amp; FormatDateTime([Sent Earliest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="69a5f33d-acd2-4bb9-9d2b-069cfc7fc32c" name="Earliest?" type="Decision"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Sent Earliest])" /><ontrue>c0a30ff4-3c4e-4a4b-81bc-22fad4bfb5e4</ontrue><onfalse>e42900f2-2408-444c-b8c0-7077cfc7ab63</onfalse></stage><stage stageid="e42900f2-2408-444c-b8c0-7077cfc7ab63" name="Latest" type="Decision"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Sent Latest])" /><ontrue>bbfb0329-e644-42ca-8e5b-91a771933be0</ontrue><onfalse>e3df62cc-bf1a-4ea1-8c56-de279ca09c6b</onfalse></stage><stage stageid="bbfb0329-e644-42ca-8e5b-91a771933be0" name="Filter Expression" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>e3df62cc-bf1a-4ea1-8c56-de279ca09c6b</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&lt;='&quot; &amp; FormatDateTime([Sent Latest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="f47c58b8-fa7d-43e4-9879-9489b3c45b64" name="Get Sent Items (Advanced)" type="SubSheetInfo"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><narrative>Lists Sent Items matching the filter provided.

Eg1 [Subject]='Exception Report'

Eg2 [To]='Mike Colleague' OR [To]='Mike Coworker'

See https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="8eb9cd1f-4784-4a10-b9f5-9257375fa249" name="Start" type="Start"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [To]='Mike Colleague' AND [SentOn]&gt;='15 January 2018 09:00' AND [SentOn]&lt;='19 January 2018 17:00'" stage="Filter Expression" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>86fdf439-537b-402e-bf87-83a0aa0186aa</onsuccess></stage><stage stageid="0db44ad5-c704-4846-be43-d47afae7ddff" name="Item Count" type="Data"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7038439e-d7a5-4958-a2a6-b7076ad6e877" name="Filter Expression" type="Data"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d8b0ade5-d70a-469c-b475-5e38be742df6" name="Outlook Folder ID" type="Data"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>5</initialvalue><private /><alwaysinit /></stage><stage stageid="86fdf439-537b-402e-bf87-83a0aa0186aa" name="Internal_Get Items" type="SubSheet"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="&quot;&quot;" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>9be25db3-9033-4941-81dc-97124e0e4917</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="9be25db3-9033-4941-81dc-97124e0e4917" name="End" type="End"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="f223606b-95bb-4058-9217-4ed244648a97" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>b846e5cd-ed99-489e-9671-08f3d63a07ff</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&gt;='&quot; &amp; FormatDateTime([Received Earliest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="020266f4-5352-4942-9ca5-2b5b2c28ba9e" name="Earliest?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Received Earliest])" /><ontrue>f223606b-95bb-4058-9217-4ed244648a97</ontrue><onfalse>b846e5cd-ed99-489e-9671-08f3d63a07ff</onfalse></stage><stage stageid="b846e5cd-ed99-489e-9671-08f3d63a07ff" name="Latest" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Received Latest])" /><ontrue>46ee2d04-b46b-4315-bd1a-abadb043b648</ontrue><onfalse>4d51e55a-9744-4090-b1d2-83bc995adeb5</onfalse></stage><stage stageid="46ee2d04-b46b-4315-bd1a-abadb043b648" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4d51e55a-9744-4090-b1d2-83bc995adeb5</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&lt;='&quot; &amp; FormatDateTime([Received Latest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="dd6e1514-fd6a-4d97-905d-55b4c8076300" name="Include Unread" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="4931c0a2-5942-4727-aa8e-c354a58dc3d9" name="Include Read" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="4d51e55a-9744-4090-b1d2-83bc995adeb5" name="Unread Only?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Include Unread]=True AND [Include Read]=False" /><ontrue>b7a34496-b13f-4bf8-a6ed-b14f0dbbfdb9</ontrue><onfalse>1d38891a-a1cf-47ac-952b-2e4f9879a947</onfalse></stage><stage stageid="1d38891a-a1cf-47ac-952b-2e4f9879a947" name="Read Only?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Include Read]=True AND [Include Unread]=False" /><ontrue>9ec12e81-08b4-4b01-a8ea-02ed52fafbf6</ontrue><onfalse>b8b8afa2-e3b6-490d-b4d1-b636fc831a96</onfalse></stage><stage stageid="9ec12e81-08b4-4b01-a8ea-02ed52fafbf6" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>59dcb54a-0ca1-49a8-9543-3581d721886e</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:read=1&quot;" stage="Filter Expression" /></stage><stage stageid="b8b8afa2-e3b6-490d-b4d1-b636fc831a96" name="Anchor1" type="Anchor"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>225</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>faa2ec03-a715-4589-a137-e014002ddca2</onsuccess></stage><stage stageid="faa2ec03-a715-4589-a137-e014002ddca2" name="Anchor1" type="Anchor"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>330</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>59dcb54a-0ca1-49a8-9543-3581d721886e</onsuccess></stage><stage stageid="59dcb54a-0ca1-49a8-9543-3581d721886e" name="Anchor1" type="Anchor"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>330</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>cf1214bb-b7fd-4fec-ab0b-dde176bcca9a</onsuccess></stage><stage stageid="fd8830ea-eced-4fa2-8bbb-3537fca5a68b" name="Get Received Items (Expert)" type="SubSheetInfo"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative>Lists Inbox Items matching the filters provided.

Eg1 @SQL=urn:schemas:httpmail:fromname='Mike Colleague' AND urn:schemas:httpmail:read=0

Eg2 @SQL=urn:schemas:httpmail:fromname='The Boss' AND urn:schemas:httpmail:subject LIKE '%Urgent%'

See https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="fcb20265-28c5-415d-a083-d217916df151" name="Start" type="Start"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="DASL Query" narrative="Mandatory. A filter using a DASL query, eg @SQL=urn:schemas:httpmail:fromname='Mike Colleague' AND (urn:schemas:httpmail:subject LIKE '%Important%' OR urn:schemas:httpmail:subject LIKE '%Urgent%')" stage="Filter Expression" /><input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." stage="Sub Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>4828b977-8cfe-494b-9d2a-5ac65c8b6834</onsuccess></stage><stage stageid="b0aadff2-6a6a-4209-aea3-5c4ad4d2161d" name="Item Count" type="Data"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ea0ad1b6-12ef-43fb-b290-11b329c2ca27" name="Filter Expression" type="Data"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ef288d41-1da1-46bc-ad92-e063e9e51137" name="Outlook Folder ID" type="Data"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="4828b977-8cfe-494b-9d2a-5ac65c8b6834" name="Internal_Get Items" type="SubSheet"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Sub Folder]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>829daa3f-c9ac-41b0-b6c9-39caf538c87e</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="829daa3f-c9ac-41b0-b6c9-39caf538c87e" name="End" type="End"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="d2fdf5b2-86dd-4f37-86cb-4bc8cc7b80b9" name="Sub Folder" type="Data"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c56f0cd2-e7f6-4a5d-a859-901d8bd2b9a1" name="Mark Email As Read" type="SubSheetInfo"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><narrative>Marks a specific email as read.

The Entry ID is the unique idenfier used to determine which email is to be marked.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="649120fc-a08c-44c6-949e-01c69a4c4d56" name="Start" type="Start"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>55267a5b-cc4a-4cc5-b141-a7c9a032924a</onsuccess></stage><stage stageid="af27f0d8-4b35-4ebb-a259-04758f73dcc3" name="End" type="End"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="55267a5b-cc4a-4cc5-b141-a7c9a032924a" name="Mark Read" type="Code"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>af27f0d8-4b35-4ebb-a259-04758f73dcc3</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
item.Unread = False]]></code></stage><stage stageid="84646f19-6d1f-4d92-a977-3058f4c582ff" name="Entry ID" type="Data"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1b9646e7-1b30-4f67-833a-3121344437ab" name="Mark Email As Unread" type="SubSheetInfo"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><narrative>Marks a specific email as unread.

The Entry ID is the unique idenfier used to determine which email is to be marked.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="4868521a-c295-4724-960a-b8a60dceae6c" name="Start" type="Start"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>cdd6c065-c7eb-4ee3-b50c-48dddee9a3aa</onsuccess></stage><stage stageid="2b8b0ae1-c806-485b-9b87-0875c17ba062" name="End" type="End"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="cdd6c065-c7eb-4ee3-b50c-48dddee9a3aa" name="Mark Unread" type="Code"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>2b8b0ae1-c806-485b-9b87-0875c17ba062</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
item.Unread = True]]></code></stage><stage stageid="9e08a8d3-4d6c-49e8-856f-664eb6e5e175" name="Entry ID" type="Data"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7643fd53-5368-45a9-8412-89b5d574c204" name="Items" type="Collection"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="4c60b4ac-e0f8-4ef7-870d-f88f5a6edade" name="Items" type="Collection"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="4ee04419-4388-4a3a-87f2-06fbe4585fdf" name="Items" type="Collection"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="c7be666f-19fe-421d-bb4d-95085817f37e" name="Items" type="Collection"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="ecaed312-c8a9-4755-b673-bdf8ce1ba59d" name="Items" type="Collection"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="2d58da80-f8b4-414e-80bb-2d87d9ce0cc4" name="Items" type="Collection"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="dc080a71-625d-45b0-bf8d-1cf2a77b3b48" name="Note2" type="Note"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><loginhibit /><narrative>NOT FOR PUBLICATION</narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="20" style="Regular" color="FF0000" /></stage><stage stageid="0b72d21e-2753-42b8-846a-bae349f2c179" name="Message" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>225</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0c46c352-79de-438b-9ce3-422dcc0fb10b" name="Filter Expression" type="Calculation"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>a3d2888f-df21-47e3-8405-7f6f4564a71b</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:textdescription LIKE '&quot;&amp;Replace([Message], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="ba79bc8b-8091-4327-b1b2-3c6ccfb3f51b" name="Message?" type="Decision"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Message]&lt;&gt;&quot;&quot;" /><ontrue>0c46c352-79de-438b-9ce3-422dcc0fb10b</ontrue><onfalse>a3d2888f-df21-47e3-8405-7f6f4564a71b</onfalse></stage><stage stageid="9eb8fa0d-8fa1-4fec-9689-c30cc9649f0a" name="Filter Expression" type="Calculation"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>020266f4-5352-4942-9ca5-2b5b2c28ba9e</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:textdescription LIKE '&quot;&amp;Replace([Message], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="f24225cb-32e2-4f31-b9f8-f75390a670a9" name="Message?" type="Decision"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Message]&lt;&gt;&quot;&quot;" /><ontrue>9eb8fa0d-8fa1-4fec-9689-c30cc9649f0a</ontrue><onfalse>020266f4-5352-4942-9ca5-2b5b2c28ba9e</onfalse></stage><stage stageid="b4632ee7-bf2b-4b55-9dca-e9a7fafca663" name="Message" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>240</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a24cb43c-102d-4964-a916-09e44168a4c1" name="Input" type="Block"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1fdeae66-adae-4ae5-bf8d-61ddb71fc904" name="Output" type="Block"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="48aa1db4-2765-4c9e-a7b6-fb0989ed93f3" name="Subject" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>225</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8eb18cc7-2d34-4dba-bcd7-32cd82d688c9" name="Input" type="Block"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>135</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e48a94c8-7d5d-40ad-89d8-4d953b6791c3" name="Output" type="Block"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="94557554-0d80-4cc4-ae14-8806264969e5" name="Input" type="Block"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="416d4ee0-5f16-4282-bec4-42328e03acb4" name="Output" type="Block"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="42b922f9-dd32-475f-a8ec-67ad770ce8ad" name="Input" type="Block"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>135</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e6d1a1b7-3b51-4ee1-8756-585e34aa936d" name="Output" type="Block"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="71f3829b-c755-4e45-a175-c3b7075af273" name="Input" type="Block"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e7e22486-0749-492f-8e67-586aa2c271ab" name="Output" type="Block"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="1846bfcf-e7b1-48ca-83fe-bd2b5a1bcbeb" name="Input" type="Block"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="5cd2cea7-99cf-42af-b4eb-7cf6b2d62958" name="Output" type="Block"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="e33d69e8-faec-46fc-a225-2ac747bddd65" name="Input" type="Block"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="49f3281d-7765-48aa-8547-fc87ba0bd110" name="Output" type="Block"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="5cfc97b8-86c5-4a5b-ae62-71e55abd988d" name="Input" type="Block"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>270</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="73da0a90-8718-4f31-a8dd-2a56a45265ed" name="Input" type="Block"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>165</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ec957629-3e89-4cd3-963b-fb0ab19dc116" name="Input" type="Block"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>165</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="bbd7d428-080a-47f0-8431-837da5d25290" name="Input" type="Block"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>240</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e15d0e55-ef6a-4836-bdb5-3ccf92b362fa" name="Input" type="Block"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>165</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e470b377-ed2e-449e-b7b1-5954285a57c1" name="Input" type="Block"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="d24d2f3f-a3dd-4e54-8c2e-dd886cb74e42" name="Input" type="Block"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="07fac98a-a954-4be7-9aff-79b761ec658d" name="Input" type="Block"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="023dcb4e-5dbd-4015-a4a4-d9825ca509b2" name="Input" type="Block"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><loginhibit /><narrative></narrative><displayx>-255</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>135</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="45c2b8cf-a653-4a26-bc25-a2009c8d3501" name="Input" type="Block"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>165</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ad7ba6e4-ef09-4fac-9dea-f535bb81aac2" name="Input" type="Block"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>165</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="dd8c58ce-3a4e-44a6-b4d8-248309fac791" name="Default" type="Block"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><loginhibit /><narrative></narrative><displayx>-255</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="63823440-c2ee-48b1-a2db-527efc5b94f7" name="Note3" type="Note"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><loginhibit /><narrative>API functions provided for the advanced filter expressions:

BCC = Returns a String representing the display list of blind carbon copy (BCC) names for a MailItem. Read/write.
Body = Returns or sets a String representing the clear-text body of the Outlook item. Read/write.
CC = Returns a String representing the display list of carbon copy (CC) names for a MailItem . Read/write.
CreationTime = Returns a Date indicating the creation time for the Outlook item. Read-only.
EntryID = Returns a String representing the unique Entry ID of the object. Read-only.
HTMLBody = Returns or sets a String representing the HTML body of the specified item. Read/write.
ReceivedTime = Returns a Date indicating the date and time at which the item was received. Read-only.
SenderEmailAddress = Returns a String that represents the e-mail address of the sender of the Outlook item. Read-only.
SenderName = Returns a String indicating the display name of the sender for the Outlook item. Read-only.
SentOn = Returns a Date indicating the date and time on which the Outlook item was sent. Read-only.
Subject = Returns or sets a String indicating the subject for the Outlook item. Read/write.
To = Returns or sets a semicolon-delimited String list of display names for the To recipients for the Outlook item. Read/write.
UnRead = Returns or sets a Boolean value that is True if the Outlook item has not been opened (read). Read/write.
</narrative><displayx>-525</displayx><displayy>-45</displayy><displaywidth>480</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="528d4d34-61bc-4a7b-b329-4bda0e6309fa" name="Note4" type="Note"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><loginhibit /><narrative>Supported API DASL filters expressions:

urn:schemas:httpmail:attachmentfilename
urn:schemas:httpmail:bcc
urn:schemas:httpmail:cc
urn:schemas:httpmail:date
urn:schemas:httpmail:datereceived
urn:schemas:httpmail:displaycc
urn:schemas:httpmail:displayto
urn:schemas:httpmail:from
urn:schemas:httpmail:fromemail
urn:schemas:httpmail:fromname
urn:schemas:httpmail:hasattachment
urn:schemas:httpmail:importance
urn:schemas:httpmail:senderemail
urn:schemas:httpmail:sendername
urn:schemas:httpmail:subject
urn:schemas:httpmail:submitted
urn:schemas:httpmail:textdescription
urn:schemas:httpmail:to
</narrative><displayx>-360</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="702f380f-35f2-4112-95d8-cdc6a3521101" name="Note3" type="Note"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><loginhibit /><narrative>API functions provided for the advanced filter expressions:

BCC = Returns a String representing the display list of blind carbon copy (BCC) names for a MailItem. Read/write.
Body = Returns or sets a String representing the clear-text body of the Outlook item. Read/write.
CC = Returns a String representing the display list of carbon copy (CC) names for a MailItem . Read/write.
CreationTime = Returns a Date indicating the creation time for the Outlook item. Read-only.
EntryID = Returns a String representing the unique Entry ID of the object. Read-only.
HTMLBody = Returns or sets a String representing the HTML body of the specified item. Read/write.
ReceivedTime = Returns a Date indicating the date and time at which the item was received. Read-only.
SenderEmailAddress = Returns a String that represents the e-mail address of the sender of the Outlook item. Read-only.
SenderName = Returns a String indicating the display name of the sender for the Outlook item. Read-only.
SentOn = Returns a Date indicating the date and time on which the Outlook item was sent. Read-only.
Subject = Returns or sets a String indicating the subject for the Outlook item. Read/write.
To = Returns or sets a semicolon-delimited String list of display names for the To recipients for the Outlook item. Read/write.
UnRead = Returns or sets a Boolean value that is True if the Outlook item has not been opened (read). Read/write.
</narrative><displayx>-525</displayx><displayy>-60</displayy><displaywidth>480</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="13bf2bea-2785-44ac-bda2-1e04f3c2a1e1" name="Note4" type="Note"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><loginhibit /><narrative>Supported API DASL filters expressions:

urn:schemas:httpmail:attachmentfilename
urn:schemas:httpmail:bcc
urn:schemas:httpmail:cc
urn:schemas:httpmail:date
urn:schemas:httpmail:datereceived
urn:schemas:httpmail:displaycc
urn:schemas:httpmail:displayto
urn:schemas:httpmail:from
urn:schemas:httpmail:fromemail
urn:schemas:httpmail:fromname
urn:schemas:httpmail:hasattachment
urn:schemas:httpmail:importance
urn:schemas:httpmail:senderemail
urn:schemas:httpmail:sendername
urn:schemas:httpmail:subject
urn:schemas:httpmail:submitted
urn:schemas:httpmail:textdescription
urn:schemas:httpmail:to
</narrative><displayx>-360</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="b1663b58-d99f-4f8e-9641-4b3db50ca615" name="Clean Up" type="Calculation"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>13e49491-8926-40a0-8c35-02e97884e4a5</onsuccess><calculation expression="Replace([File Name],&quot;&quot;&quot;&quot;,&quot;&quot;)" stage="File Name" /></stage><stage stageid="80208144-c05c-4b32-bd6a-de8320da32e5" name="New Entry ID" type="Data"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="243bb204-edf5-4efc-a5bd-60f234cc9d18" name="Profile" type="Data"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="37e8bd4c-d3bf-4481-80a5-3ad008b54edc" name="Profile" type="Data"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="11ac7dd4-0456-4460-bbaa-a5e49aa4bf26" name="Profile" type="Data"><subsheetid>9bf4e24d-5759-4357-97f1-adc1c08c843a</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="40725bbe-592f-403d-8477-e7b55099b08b" name="Profile" type="Data"><subsheetid>2e6fb66c-9607-4731-829c-e3dfd4510a95</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8881d3f0-05bd-4b12-9841-b6f0067fbe13" name="Profile" type="Data"><subsheetid>5734e4af-7917-40d8-b0b6-83d8e1872074</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9d96b872-8a72-4ca0-bb95-4b6785b8a6b2" name="Profile" type="Data"><subsheetid>204201c2-30d3-467a-b6fb-4e0010b046af</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7b6c5433-35d1-4a20-af93-30c2775b85b4" name="Profile" type="Data"><subsheetid>2d1820f0-98e4-4a10-8361-8f5322babcee</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7518d950-6a23-41e3-9006-2bd96d18a756" name="Profile" type="Data"><subsheetid>61b6fc18-b98a-4456-9381-8c8cfe9f6f60</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dec83edb-bd89-4f46-8612-95431da8e1ad" name="Profile" type="Data"><subsheetid>758f4938-75a1-4157-b0f7-2d9b99144d61</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="36d86a8b-5ecb-432c-af08-f5d79e479ef4" name="Profile" type="Data"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9c38178a-8684-4718-91e3-57f7012f9fca" name="Profile" type="Data"><subsheetid>7aafcecd-5e8f-49d4-9987-73958f3cedc3</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="27e8a9af-c363-4a28-9a83-6b40aa9176bd" name="Profile" type="Data"><subsheetid>d9c8a6c7-f973-45af-b333-8166a34297c7</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1c460cc1-810d-4253-bc41-d1add1dda612" name="Profile" type="Data"><subsheetid>43fde12c-9d96-4cdd-a342-88204c037438</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="73a2ef67-5681-45c1-a5ff-ca5178fb0f46" name="Profile" type="Data"><subsheetid>a2bc0172-492f-4781-b7ed-1f1d550da3ba</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a33c2608-1e5c-4a85-91ef-5609f50c87f6" name="Profile" type="Data"><subsheetid>f28aad59-a89a-4a9c-98ab-d31d6b69d9a5</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a9786ab7-546d-44db-aebd-542b656969ae" name="Profile" type="Data"><subsheetid>ea004198-e1fb-44bc-b549-bf8f7fa06631</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2c582ea6-6154-4c20-bc69-970494712c15" name="Profile" type="Data"><subsheetid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4b1659b5-2195-4820-8acf-729782ecf495" name="Encode HTML as ASCII" type="SubSheetInfo"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><narrative>Use this action to encode any unicode characters in your HTML as ASCII characters. This is required to send HTML containing unicode characters with the 'Send Message' action.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="83bef862-0626-4fb8-8e50-34bee3cfae95" name="Start" type="Start"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="HTML" narrative="HTML containing unicode characters" stage="HTML" /></inputs><onsuccess>9ee88069-8ef2-4fbb-94d2-c049793231c1</onsuccess></stage><stage stageid="06ee0879-feff-4e97-9709-c91e62b28793" name="End" type="End"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Encoded" narrative="HTML with the unicode characters escaped as HTML entities." stage="Encoded" /></outputs></stage><stage stageid="9ee88069-8ef2-4fbb-94d2-c049793231c1" name="Encode HTML" type="Code"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="HTML" expr="[HTML]" /></inputs><outputs><output type="text" name="Encoded" stage="Encoded" /></outputs><onsuccess>06ee0879-feff-4e97-9709-c91e62b28793</onsuccess><code><![CDATA[Encoded = EncodeHTMLAsASCII(HTML)
]]></code></stage><stage stageid="fae4bc46-6318-4864-9129-6d1dacd4de7f" name="HTML" type="Data"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="440f309c-a9b4-4da9-aa3e-c6b399a92b81" name="Encoded" type="Data"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ca558d60-4726-44ec-bf21-4dc85d417ffd" name="Input" type="Block"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>75</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1810be8e-a68a-48a5-beca-a82fd73d43a3" name="Output" type="Block"><subsheetid>518068f5-ac12-4776-b94d-e5e24c7bd7a0</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="0f906879-fd1c-4f43-87f4-90e11d943c3b" name="Get Contacts" type="SubSheetInfo"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><narrative>BACKWARD COMPATIBILITY NOTE: The field name "Business Phone No." in the contacts collection is invalid - it has been changed to "Business Phone No", ie. the trailing full stop has been removed.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="3fe977fb-44ef-4b25-a130-e3f4f3341600" name="Start" type="Start"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><loginhibit /><preconditions><condition narrative="A valid default email account must be set up for the Profile. No other email clients (e.g. Outlook) should be running." /></preconditions><postconditions><condition narrative="Contacts returned" /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /><input type="text" name="Given Name" narrative="The First name of the contact to get" stage="Given Name" /><input type="text" name="Surname" narrative="The Surname of the contact to get" stage="Surname" /></inputs><onsuccess>814b0087-4e13-47e7-b0c4-e4a295c242a9</onsuccess></stage><stage stageid="3e106446-2189-42df-b2f8-49e89078c3b4" name="End" type="End"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Contacts" narrative="Collection containing contacts that match the surname and given name, if more than one contact matches several rows will be returned in the collection" stage="Contacts" /></outputs></stage><stage stageid="814b0087-4e13-47e7-b0c4-e4a295c242a9" name="GetContacts Code" type="Code"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Profile" narrative="The mail client profile to use" expr="[Profile]" /><input type="text" name="Given Name" narrative="The First name of the contact to get" expr="[Given Name]" /><input type="text" name="Surname" narrative="The Surname of the contact to get" expr="[Surname]" /></inputs><outputs><output type="collection" name="Contacts" narrative="Collection containing contacts that match the surname and given name, if more than one contact matches several rows will be returned in the collection" stage="Contacts" /></outputs><onsuccess>3e106446-2189-42df-b2f8-49e89078c3b4</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim mapi = app.GetNameSpace("MAPI")
mapi.Logon(Profile)

Contacts = New System.Data.DataTable()
Contacts.Columns.Add("Full Name")
Contacts.Columns.Add("Job Title")
Contacts.Columns.Add("Display Name")
Contacts.Columns.Add("Email Address")
Contacts.Columns.Add("Business Phone No")
Contacts.Columns.Add("Company")

Dim folderContacts As MAPIFolder = mapi.GetDefaultFolder(OlDefaultFolders.olFolderContacts)
Dim folderItems As Items = folderContacts.Items
Dim i As Integer = 1

While folderItems.Count >= i
	Dim itemObj As Object = folderItems(i)

	If TypeOf itemObj Is ContactItem Then
		Dim contactItem As ContactItem = (TryCast(itemObj, ContactItem))
		Contacts.Rows.Add(New Object() {contactItem.FullName, contactItem.JobTitle, contactItem.FileAs, contactItem.Email1Address, contactItem.BusinessTelephoneNumber, contactItem.CompanyName})
	End If

	i += 1
End While
]]></code></stage><stage stageid="7e080d9f-b2d5-4706-b7aa-d77062264353" name="Profile" type="Data"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="27608c4a-680b-4b19-9440-14008a12d85b" name="Given Name" type="Data"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0adaec03-2efe-495c-af84-4a5e34b3ffb4" name="Surname" type="Data"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="30ed72c7-794e-4644-85bd-4614def4d239" name="Contacts" type="Collection"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="79685cf1-a86c-4e9e-bf86-98cac3d0f1a0" name="Input" type="Block"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><loginhibit /><narrative></narrative><displayx>-255</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f0bf9876-1ba7-4b17-b457-836672a15641" name="Output" type="Block"><subsheetid>c589c8f4-dd00-4bf1-a280-0344d74d0afb</subsheetid><loginhibit /><narrative></narrative><displayx>-255</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="99c21f93-5d7c-41b0-a2e8-0c7a73e706d4" name="Save Email as PDF" type="SubSheetInfo"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><narrative>Added Initial Wait Time to allow some time to load the file before converting to PDF file. </narrative><displayx>-240</displayx><displayy>-150</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="fc2bd05e-d2e6-4c57-b3e7-7bd634fa255b" name="Start" type="Start"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /><input type="text" name="PDF File Path" narrative="Full path of PDF file to save" stage="PDF File Path" /><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Message ID" /><input type="number" name="Initial Wait Time" narrative="Value in milliseconds" stage="Initial Wait Time" /></inputs><onsuccess>a7a1a524-1644-405c-81e2-94ff6d55927d</onsuccess></stage><stage stageid="9d9cb4af-eb83-49da-9eb0-2d9353758f0c" name="End" type="End"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="4c5cb54a-ec86-4b33-84cf-40d584285952" name="Message ID" type="Data"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="52a60ed7-1787-4c54-99b8-01a3087b3ae9" name="PDF File Path" type="Data"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5138e5ef-951c-4bdc-89d5-de50ad3fbf45" name="Profile" type="Data"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Outlook</initialvalue><private /><alwaysinit /></stage><stage stageid="a7a1a524-1644-405c-81e2-94ff6d55927d" name="Save as PDF" type="Code"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Profile" narrative="The mail client profile to use" expr="[Profile]" /><input type="text" name="Entry_ID" narrative="The unique ID of the email message" expr="[Message ID]" /><input type="text" name="FileLocation" expr="[PDF File Path]" /><input type="number" name="PageWidth" expr="[Page Width]" /><input type="text" name="strPageSize" expr="[PageSize]" /><input type="number" name="Initial Wait Time" expr="[Initial Wait Time]" /></inputs><onsuccess>9d9cb4af-eb83-49da-9eb0-2d9353758f0c</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)

Dim msg As MailItem = TryCast(item, MailItem)

Dim flag As Boolean=False
Dim Body As string=""

If msg.HTMLBody.Length > 0 Then
	
	Body = msg.HTMLBody
	
	If Body.StartsWith("<") Then
		flag=True
	End If

End If

If flag = False Then
	Body = "<html><body>" & msg.Body & "</body></html>"
	
	Dim bytes2() As Byte = System.Text.Encoding.ASCII.GetBytes(Body)
	Body = ""
	For Each ch As Byte In bytes2
		If ch = 13 Then
			Body = Body & "<br/>"
		ElseIf ch = 10 Then
		Else
			Dim bytes(1 * 0) As Byte
			bytes(0) = ch
			Dim newText As String = System.Text.Encoding.ASCII.GetString(bytes)
			Body = Body & newText
		End If
	Next
End If

Dim file As System.IO.StreamWriter
file = My.Computer.FileSystem.OpenTextFileWriter(FileLocation.ToLower().Replace(".pdf",".html"), False)
file.WriteLine(Body)
file.Close()

Dim filename As Object = FileLocation.ToLower().Replace(".pdf",".html")

Dim htmlContent As String = System.IO.File.ReadAllText(filename)

htmlContent = GetStrippedMessage(htmlContent)

Dim dirLoc As String = filename.Substring(0, filename.LastIndexOf("\"))

If System.IO.Directory.Exists(dirLoc & Convert.ToString("\PDFImages")) Then
	Dim di As System.IO.DirectoryInfo = New System.IO.DirectoryInfo(dirLoc & Convert.ToString("\PDFImages"))
	For Each imgFile As System.IO.FileInfo In di.GetFiles()
		imgFile.Delete()
	Next
Else
	System.IO.Directory.CreateDirectory(dirLoc & Convert.ToString("\PDFImages"))
End If

Dim start As Integer = 0
Dim [end] As Integer = -1

While True
	[end] = htmlContent.IndexOf("<img", start, StringComparison.CurrentCultureIgnoreCase)
	If [end] = -1 Then
		Exit While
	End If

	Dim imgStart As Integer = htmlContent.IndexOf("src", [end], StringComparison.CurrentCultureIgnoreCase)
	imgStart = htmlContent.IndexOf("=", imgStart) + 1

	Dim imgSource As String = htmlContent.Substring(imgStart)

	Dim imgEnd As Integer = htmlContent.IndexOf(imgSource(0), imgStart + 1)

	imgSource = htmlContent.Substring(imgStart + 1, (imgEnd - imgStart - 1))

	start = [end] + 1
	Try
		Using client As New System.Net.WebClient()
			If imgSource.StartsWith("cid:", StringComparison.CurrentCultureIgnoreCase) Then
				imgSource = imgSource.Substring(4)
				imgSource = imgSource.Substring(0, imgSource.IndexOf("@"))

				htmlContent = htmlContent.Remove(imgStart + 1, imgEnd - imgStart - 1)
				htmlContent = htmlContent.Insert(imgStart + 1, "PDFImages/" & imgSource)
			Else
				Dim imgName As String = imgSource.Substring(imgSource.LastIndexOf("/") + 1)

				Dim _newName As String = Guid.NewGuid().ToString() + ".png"
				client.DownloadFile(New Uri(imgSource), Convert.ToString(dirLoc & Convert.ToString("\PDFImages\")) & _newName)

				htmlContent = htmlContent.Remove(imgStart + 1, imgEnd - imgStart - 1)
				Dim newSource As String = Convert.ToString("PDFImages/") & _newName

				htmlContent = htmlContent.Insert(imgStart + 1, newSource)
			End If
		End Using
	Catch
	End Try
End While
System.IO.File.WriteAllText(filename, htmlContent)

'word to pdf
Dim word As New Microsoft.Office.Interop.Word.Application()

Dim oMissing As Object = System.Reflection.Missing.Value
word.Visible = False
word.ScreenUpdating = False

Dim doc As Document = word.Documents.Open(filename, oMissing, oMissing, oMissing, oMissing, oMissing, _
	oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, _
	oMissing, oMissing, oMissing, oMissing)
System.Threading.Thread.Sleep(Initial_Wait_Time)			
doc.Activate()

Dim outputFileName As Object = FileLocation
Dim fileFormat As Object = WdSaveFormat.wdFormatPDF
doc.SaveAs(outputFileName, fileFormat, oMissing, oMissing, oMissing, oMissing, _
	oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, _
	oMissing, oMissing, oMissing, oMissing)
Dim saveChanges As Object = WdSaveOptions.wdDoNotSaveChanges
DirectCast(doc, _Document).Close(saveChanges, oMissing, oMissing)
doc = Nothing
DirectCast(word, Microsoft.Office.Interop.Word._Application).Quit(oMissing, oMissing, oMissing)
word = Nothing

Dim imgDi As System.IO.DirectoryInfo = New System.IO.DirectoryInfo(dirLoc & Convert.ToString("\PDFImages"))
For Each imgFile As System.IO.FileInfo In imgDi.GetFiles()
	imgFile.Delete()
Next

System.IO.File.Delete(filename)
System.IO.Directory.Delete( dirLoc & Convert.ToString("\PDFImages") )
]]></code></stage><stage stageid="6a21b180-2e6a-4f6f-b596-83a3cb0c833b" name="Page Width" type="Data"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>1000</initialvalue><private /><alwaysinit /></stage><stage stageid="be122d7a-b1c1-4893-b27b-93dd0874d714" name="PageSize" type="Data"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">A4</initialvalue><private /><alwaysinit /></stage><stage stageid="2ccc5809-f742-486e-a60a-50d84f560b3b" name="Initial Wait Time" type="Data"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4c632acd-d393-42fd-baea-7f54a5481184" name="Input" type="Block"><subsheetid>8b7411f0-ef45-49d1-9995-b1f717d11fa6</subsheetid><loginhibit /><narrative></narrative><displayx>-315</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="2a3049f3-0023-4c4f-a4f2-b1478c9dac5b" name="Profile" type="Data"><subsheetid>e0b58522-643b-42ad-8fdd-4cb5246c5558</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="13e49491-8926-40a0-8c35-02e97884e4a5" name="Save Attachments1" type="Code"><subsheetid>41e124bf-bc71-4b3c-9b3b-9f5d8b8fd79f</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Folder Path" expr="[Folder Path]" /><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="File Pattern" expr="[File Name]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><onsuccess>a8e9b1e1-4b0f-487d-89a5-6cacb4092be4</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
If item Is Nothing Then Return

If Not Folder_Path.EndsWith("\") Then Folder_Path &="\"

For Each attachment As Object In item.Attachments
	If (attachment.Type = 1 OrElse attachment.Type = 5) AndAlso attachment.FileName Like File_Pattern Then
		attachment.SaveAsFile(Folder_Path & attachment.FileName)
	End If
Next
]]></code></stage><stage stageid="28488e6d-4baf-4f91-9c2e-f0ffe7b52c30" name="Attachments" type="Data"><subsheetid>f6f16944-bdad-4ff4-a5df-b687b904183c</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0dc9746d-1fca-44ce-aef0-0e2b33335394" name="Attachments" type="Data"><subsheetid>78125029-0b28-4ee1-a064-c3a9e70ad7ca</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c0088039-d72f-4a92-b9c5-57a314d3a79f" name="Get Items Global (Basic)" type="SubSheetInfo"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative>Lists Inbox items matching the parameters provided</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="2d928fa8-888f-47f6-ba77-2fc89fd61653" name="Item Count" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>270</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0c543cbe-4f4c-4e0d-87d3-e985dec7dc07" name="Internal_Get Items" type="SubSheet"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>420</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Destination Folder Path]" /><input type="text" name="Profile" narrative="The mail client profile to use" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>9623d125-3995-4761-8e6d-57e8f3ce101e</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="b05bf295-b927-4c28-b636-fcce33dea8e4" name="Outlook Folder ID" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>-1</initialvalue><private /><alwaysinit /></stage><stage stageid="6456087e-6476-4ac9-9d2d-051b97bf7108" name="Destination Folder Path" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9623d125-3995-4761-8e6d-57e8f3ce101e" name="End" type="End"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>480</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="d54695be-0b7f-4590-98a0-0dbe99ad4773" name="Subject" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>240</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7a7d874b-fdaf-42b4-a24d-53a7e3c24d6b" name="Start" type="Start"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Sender Name" narrative="Optional. The From display name, which might be a name (eg John Smith) or email address (eg admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the From field." stage="Sender Name" /><input type="text" name="Sender Email" narrative="Optional. The sender email address." stage="Sender Email" /><input type="datetime" name="Received Earliest" narrative="Optional. The earliest date to search from." stage="Received Earliest" /><input type="datetime" name="Received Latest" narrative="Optional. The latest date to search to." stage="Received Latest" /><input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." stage="Subject" /><input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" stage="Message" /><input type="flag" name="Include Read" narrative="Optional, default True" stage="Include Read" /><input type="flag" name="Include Unread" narrative="Optional, default True" stage="Include Unread" /><input type="text" name="Destination Folder Path" narrative="Mandatory. Any alphanumeric value valid. The Subfolder in the root folder, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Inbox, needs to be declared as &quot;Inbox\Subfolder B&quot;." stage="Destination Folder Path" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>b7606eff-e521-4e7f-8cf4-4254a56a8542</onsuccess></stage><stage stageid="7c79aff6-0003-41af-a27d-cf9f7f36b045" name="Received Earliest" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>240</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="856e4d9c-aadb-49c4-b691-21f03f8a854d" name="Received Latest" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>240</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="57567828-c05a-413c-8d1e-d061d8d31c9c" name="Filter Expression" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b7606eff-e521-4e7f-8cf4-4254a56a8542" name="Sender Name?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sender Name]&lt;&gt;&quot;&quot;" /><ontrue>1c697b25-614d-40de-b892-8d8b9a854506</ontrue><onfalse>5b78cedc-7254-4970-914c-480906f7de14</onfalse></stage><stage stageid="1c697b25-614d-40de-b892-8d8b9a854506" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5b78cedc-7254-4970-914c-480906f7de14</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:sendername LIKE '&quot;&amp;Replace([Sender Name], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="cacf2c3d-252f-44ed-9e1a-307a44d77b0c" name="Clean Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>330</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>517f51ff-1b94-4bad-ab15-0ea3301e4ec2</onsuccess><calculation expression="Trim(Mid([Filter Expression], 6, Len([Filter Expression])))" stage="Filter Expression" /></stage><stage stageid="ca7c9f07-a879-4920-bd4a-4c623d6bfd9b" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>0a854cf3-2dee-42f2-898d-a3ad1dad953c</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:subject LIKE '&quot;&amp;Replace([Subject], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="a70919c6-c8e4-4c09-b1f7-9bd5b56b32e0" name="Subject?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Subject]&lt;&gt;&quot;&quot;" /><ontrue>ca7c9f07-a879-4920-bd4a-4c623d6bfd9b</ontrue><onfalse>0a854cf3-2dee-42f2-898d-a3ad1dad953c</onfalse></stage><stage stageid="5b78cedc-7254-4970-914c-480906f7de14" name="Sender Email?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sender Email]&lt;&gt;&quot;&quot;" /><ontrue>c363aba2-1668-4e25-a613-290e687b5154</ontrue><onfalse>a70919c6-c8e4-4c09-b1f7-9bd5b56b32e0</onfalse></stage><stage stageid="c363aba2-1668-4e25-a613-290e687b5154" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>a70919c6-c8e4-4c09-b1f7-9bd5b56b32e0</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:senderemail LIKE '&quot;&amp;Replace([Sender Email], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="785f317f-ce35-48ff-9d75-113155419fcf" name="Sender Name" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>240</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3d67cb34-5772-428b-91c1-d174cc4fd99a" name="Sender Email" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>240</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="517f51ff-1b94-4bad-ab15-0ea3301e4ec2" name="Filter Expression?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Filter Expression]&lt;&gt;&quot;&quot;" /><ontrue>6a1b2d3a-c21a-470e-bc3c-c9a230c53ee0</ontrue><onfalse>0c543cbe-4f4c-4e0d-87d3-e985dec7dc07</onfalse></stage><stage stageid="6a1b2d3a-c21a-470e-bc3c-c9a230c53ee0" name="Prepend" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>0c543cbe-4f4c-4e0d-87d3-e985dec7dc07</onsuccess><calculation expression="&quot;@SQL=&quot;&amp;[Filter Expression]" stage="Filter Expression" /></stage><stage stageid="85fdd446-d045-4a28-b9fd-1f2172b3227a" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>cacf2c3d-252f-44ed-9e1a-307a44d77b0c</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:read=0&quot;" stage="Filter Expression" /></stage><stage stageid="f93787da-6af5-4348-aca7-13e1d52a87ba" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>513f4302-3d08-4804-8f25-6a8572dc1e5a</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&gt;='&quot; &amp; FormatDateTime([Received Earliest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="01a73175-b5aa-4292-965c-598022c076f2" name="Earliest?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Received Earliest])" /><ontrue>f93787da-6af5-4348-aca7-13e1d52a87ba</ontrue><onfalse>513f4302-3d08-4804-8f25-6a8572dc1e5a</onfalse></stage><stage stageid="513f4302-3d08-4804-8f25-6a8572dc1e5a" name="Latest" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Received Latest])" /><ontrue>fe93d3ac-9000-4fa7-bf2d-3abe596fb79d</ontrue><onfalse>33001138-0331-4c89-b318-17ab8b4525c4</onfalse></stage><stage stageid="fe93d3ac-9000-4fa7-bf2d-3abe596fb79d" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>33001138-0331-4c89-b318-17ab8b4525c4</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&lt;='&quot; &amp; FormatDateTime([Received Latest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="2fc1174c-e05c-4cc9-ba23-8dd42e9b09ea" name="Include Unread" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="30c3d69f-eb43-49db-b5e2-fe9cd49e49f8" name="Include Read" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="33001138-0331-4c89-b318-17ab8b4525c4" name="Unread Only?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Include Unread]=True AND [Include Read]=False" /><ontrue>85fdd446-d045-4a28-b9fd-1f2172b3227a</ontrue><onfalse>aed5600e-f00d-41c4-913d-a639a1032f8e</onfalse></stage><stage stageid="aed5600e-f00d-41c4-913d-a639a1032f8e" name="Read Only?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Include Read]=True AND [Include Unread]=False" /><ontrue>9dce106b-e151-4468-bf05-51fb0f1f1ddd</ontrue><onfalse>8b5aa48b-42ce-40ae-81e0-ec344350ecd5</onfalse></stage><stage stageid="9dce106b-e151-4468-bf05-51fb0f1f1ddd" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>2b14aa6a-2266-4245-a0b8-e1b182bb92af</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:read=1&quot;" stage="Filter Expression" /></stage><stage stageid="8b5aa48b-42ce-40ae-81e0-ec344350ecd5" name="Anchor1" type="Anchor"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>225</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>e495d072-7490-4167-9fae-fb1d4de2f814</onsuccess></stage><stage stageid="e495d072-7490-4167-9fae-fb1d4de2f814" name="Anchor1" type="Anchor"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>330</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>2b14aa6a-2266-4245-a0b8-e1b182bb92af</onsuccess></stage><stage stageid="2b14aa6a-2266-4245-a0b8-e1b182bb92af" name="Anchor1" type="Anchor"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>330</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>cacf2c3d-252f-44ed-9e1a-307a44d77b0c</onsuccess></stage><stage stageid="384f97d8-dfc2-474f-a6c3-21ca60e16a3e" name="Items" type="Collection"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="6752acbd-9c00-461c-b175-f0eb5212706c" name="Filter Expression" type="Calculation"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>01a73175-b5aa-4292-965c-598022c076f2</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:textdescription LIKE '&quot;&amp;Replace([Message], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="0a854cf3-2dee-42f2-898d-a3ad1dad953c" name="Message?" type="Decision"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Message]&lt;&gt;&quot;&quot;" /><ontrue>6752acbd-9c00-461c-b175-f0eb5212706c</ontrue><onfalse>01a73175-b5aa-4292-965c-598022c076f2</onfalse></stage><stage stageid="e2d77ffc-ff15-4c76-aef4-44cb17ef9081" name="Message" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>240</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bb4a8b8d-b780-47f1-a38c-0bfb34de7e40" name="Input" type="Block"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="393b3a1e-b33f-476a-9b5f-0696739b34f8" name="Output" type="Block"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="8db689ac-4577-478b-9850-709e6bc28aa5" name="Profile" type="Data"><subsheetid>4eaf49ba-4a8f-4e07-abd8-99ed82d06dfa</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a0b58c96-cbe4-46be-9f47-c4ec9ea0b430" name="Get Items Global (Advanced)" type="SubSheetInfo"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative>Lists Inbox items matching the filter provided

Eg1 [From]='Mike Coworker' AND [unread]=False

Eg2 [Unread]=True AND [ReceivedTime] &gt;= '2018/01/01'

See https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="a561b60d-cef8-4aeb-99a1-dcd436ceefd7" name="Start" type="Start"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" stage="Filter Expression" /><input type="text" name="Destination Folder Path" narrative="Mandatory. Any alphanumeric value valid. The Subfolder in the root folder, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Inbox, needs to be declared as &quot;Inbox\Subfolder B&quot;." stage="Destination Folder Path" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>770da9d7-9377-45e1-bee5-2f7a30115794</onsuccess></stage><stage stageid="7bf78d7a-5690-45e9-9d1f-29b0128dc3b0" name="Item Count" type="Data"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5737d3ad-20bf-4570-80e3-c22580c4e51d" name="Filter Expression" type="Data"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="770da9d7-9377-45e1-bee5-2f7a30115794" name="Internal_Get Items" type="SubSheet"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Destination Folder Path]" /><input type="text" name="Profile" narrative="The mail client profile to use" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>9ec12ea8-7afd-4092-95cf-bbf11b237173</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="41aa3b61-44d0-4432-8a4b-671a4114869a" name="Outlook Folder ID" type="Data"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>-1</initialvalue><private /><alwaysinit /></stage><stage stageid="f6dcb6f2-d356-4907-bdb1-91419551af07" name="Destination Folder Path" type="Data"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9ec12ea8-7afd-4092-95cf-bbf11b237173" name="End" type="End"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="e554127c-c3e8-4368-bf08-2f28905661fc" name="Items" type="Collection"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="82ca090d-731a-4617-b65d-519aa1917716" name="Input" type="Block"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="20ad787f-aab9-4aa8-8f4a-658147cc6a8b" name="Output" type="Block"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="b091c09f-bc9c-433b-934e-39ee1b0f5e53" name="Note3" type="Note"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><loginhibit /><narrative>API functions provided for the advanced filter expressions:

BCC = Returns a String representing the display list of blind carbon copy (BCC) names for a MailItem. Read/write.
Body = Returns or sets a String representing the clear-text body of the Outlook item. Read/write.
CC = Returns a String representing the display list of carbon copy (CC) names for a MailItem . Read/write.
CreationTime = Returns a Date indicating the creation time for the Outlook item. Read-only.
EntryID = Returns a String representing the unique Entry ID of the object. Read-only.
HTMLBody = Returns or sets a String representing the HTML body of the specified item. Read/write.
ReceivedTime = Returns a Date indicating the date and time at which the item was received. Read-only.
SenderEmailAddress = Returns a String that represents the e-mail address of the sender of the Outlook item. Read-only.
SenderName = Returns a String indicating the display name of the sender for the Outlook item. Read-only.
SentOn = Returns a Date indicating the date and time on which the Outlook item was sent. Read-only.
Subject = Returns or sets a String indicating the subject for the Outlook item. Read/write.
To = Returns or sets a semicolon-delimited String list of display names for the To recipients for the Outlook item. Read/write.
UnRead = Returns or sets a Boolean value that is True if the Outlook item has not been opened (read). Read/write.
</narrative><displayx>-525</displayx><displayy>-45</displayy><displaywidth>480</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="6bdd92d6-a2b2-4e12-9b45-238d2ff5fe6b" name="Profile" type="Data"><subsheetid>df118776-808b-4c4e-a6d7-0281ffa4bb80</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a4e57bcc-5205-4445-af3e-0d29184a5e39" name="Get Items Global (Expert)" type="SubSheetInfo"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative>Lists Inbox Items matching the filters provided.

Eg1 @SQL=urn:schemas:httpmail:fromname='Mike Colleague' AND urn:schemas:httpmail:read=0

Eg2 @SQL=urn:schemas:httpmail:fromname='The Boss' AND urn:schemas:httpmail:subject LIKE '%Urgent%'

See https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="7ba4d08d-420c-445c-9f23-9834b0ac1f48" name="Start" type="Start"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="DASL Query" narrative="Mandatory. A filter using a DASL query, eg @SQL=urn:schemas:httpmail:fromname='Mike Colleague' AND (urn:schemas:httpmail:subject LIKE '%Important%' OR urn:schemas:httpmail:subject LIKE '%Urgent%')" stage="Filter Expression" /><input type="text" name="Destination Folder Path" narrative="Mandatory. Any alphanumeric value valid. The Subfolder in the root folder, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Inbox, needs to be declared as &quot;Inbox\Subfolder B&quot;." stage="Destination Folder Path" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>4eafa3b1-c713-43d8-8260-48ce5ca7945a</onsuccess></stage><stage stageid="1f22635d-2cec-4211-b819-67389ce70c17" name="Item Count" type="Data"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="509920f1-315e-4dd0-a253-41659e1c573a" name="Filter Expression" type="Data"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="02d82fd0-cd94-48a5-ac96-6da90ce80b22" name="Outlook Folder ID" type="Data"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>-1</initialvalue><private /><alwaysinit /></stage><stage stageid="4eafa3b1-c713-43d8-8260-48ce5ca7945a" name="Internal_Get Items" type="SubSheet"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Destination Folder Path]" /><input type="text" name="Profile" narrative="The mail client profile to use" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>475cc1c5-46b9-452d-ab70-d5891841c6db</onsuccess><processid>fb0dd28d-2875-4ec6-b6d5-475120ac222c</processid></stage><stage stageid="475cc1c5-46b9-452d-ab70-d5891841c6db" name="End" type="End"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="02b187b7-5912-44f2-8c64-4510f41bfced" name="Destination Folder Path" type="Data"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e5374586-4505-4a18-b183-e8efa664a1c7" name="Items" type="Collection"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /></collectioninfo></stage><stage stageid="38b847a9-d17a-4836-a9fa-a27072cfe6e2" name="Input" type="Block"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e1b6cfe2-615d-4c65-bfa8-b9b015a2809a" name="Output" type="Block"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="e71fa499-e267-4102-b026-c4fa85ccab86" name="Note4" type="Note"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><loginhibit /><narrative>Supported API DASL filters expressions:

urn:schemas:httpmail:attachmentfilename
urn:schemas:httpmail:bcc
urn:schemas:httpmail:cc
urn:schemas:httpmail:date
urn:schemas:httpmail:datereceived
urn:schemas:httpmail:displaycc
urn:schemas:httpmail:displayto
urn:schemas:httpmail:from
urn:schemas:httpmail:fromemail
urn:schemas:httpmail:fromname
urn:schemas:httpmail:hasattachment
urn:schemas:httpmail:importance
urn:schemas:httpmail:senderemail
urn:schemas:httpmail:sendername
urn:schemas:httpmail:subject
urn:schemas:httpmail:submitted
urn:schemas:httpmail:textdescription
urn:schemas:httpmail:to
</narrative><displayx>-360</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="907dafe2-b0b8-4d9f-95fb-5e6cf2f03687" name="Profile" type="Data"><subsheetid>5be4d12d-b679-4082-820f-35101beb093e</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="beacca1b-947e-47b7-8ea5-6eeb577fb6dd" name="Forward Email (Custom Subject)" type="SubSheetInfo"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative>Forward Email to recipients (To/CC/BCC) including (Message) as input parameters.

The &lt;Forward Email&gt; action will only call one ID specific (Entry ID) email item. 

If multiple emails are expected to be called, the process design would need to reflect that requirement.</narrative><displayx>-195</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="06139929-56c3-4916-a261-6c77a28d0309" name="End" type="End"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="d0dbae42-0334-4648-9992-36c3b772dd2e" name="Entry ID" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d6f6f1b2-bc45-4a9f-a932-3a24e7cceef2" name="Message" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d792d761-e53d-4202-92a3-97909ac03920" name="Forward with Subject" type="Code"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="To" expr="[To]" /><input type="text" name="CC" expr="[CC]" /><input type="text" name="BCC" expr="[BCC]" /><input type="text" name="Message" expr="[Message]" /><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Profile" expr="[Profile]" /><input type="text" name="Subject" expr="[Subject]" /></inputs><onsuccess>06139929-56c3-4916-a261-6c77a28d0309</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim item = _nameSpace.GetItemFromID(Entry_ID)
Dim mail = item.Forward
Dim addressCount As Integer

If [To] <> "" Then
	Dim toAddresses = Split([To], ";")
	For addressCount = LBound(toAddresses) To UBound(toAddresses)
	Dim recipient = mail.Recipients.Add(toAddresses(addressCount)) 
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olTo
	Next

End If

If CC <> "" Then
	Dim ccAddresses = Split([CC], ";")
	addressCount = 0
	For addressCount = LBound(ccAddresses) To UBound(ccAddresses)
	Dim recipient = mail.Recipients.Add(ccAddresses(addressCount))
	recipient.Resolve	
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olCC
	Next

End If
	
If BCC <> "" Then
	Dim bccAddresses = Split([BCC], ";")
	addressCount = 0
	For addressCount = LBound(bccAddresses) To UBound(bccAddresses)
	Dim recipient = mail.Recipients.Add(bccAddresses(addressCount))
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olBCC
	Next

End If
If Subject <> "" Then
	mail.Subject = Subject
End If
mail.HTMLBody = Message & vbCrLf & mail.HTMLBody
mail.Save
mail.Send]]></code></stage><stage stageid="03718539-bdce-4c26-99cf-023866a3d602" name="To" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fba4ced4-4ac5-47bd-98a9-7a26e36a1771" name="CC" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4ddfab06-b287-4ec7-94bb-26201b152bd9" name="BCC" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="769a0197-c0ec-4c8a-8733-7e4d0c77d9f4" name="Start" type="Start"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" stage="To" /><input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="CC" /><input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="BCC" /><input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." stage="Message" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /><input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." stage="Subject" /></inputs><onsuccess>d792d761-e53d-4202-92a3-97909ac03920</onsuccess></stage><stage stageid="79e4a72e-e2c1-4967-97eb-e2be33e29b28" name="Input" type="Block"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>240</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="820548a3-3a0b-49c9-9e25-05e5f19de849" name="Profile" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8573c12a-0b41-4090-85b1-ec7c78dc6505" name="Subject" type="Data"><subsheetid>7e173ed6-d754-4852-a127-5e593aa1aca2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>255</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="86df4f2b-b601-4d2f-99e5-13015e7d3447" name="Custom Reply" type="SubSheetInfo"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative>Reply to Email sender of a specific email.

The &lt;Reply to Email&gt; action will only call one ID specific (Entry ID) email item. 

If multiple emails are expected to be called, the process design would need to reflect that requirement.</narrative><displayx>-165</displayx><displayy>-60</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="31caf02a-41b3-43a4-b2a2-a8dd383f44b5" name="End" type="End"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="247091c7-9032-4ee4-8065-af95811fd285" name="Start" type="Start"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." stage="Entry ID" /><input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." stage="Message" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /><input type="text" name="Attachments" narrative="Optional, Semi-Colon-separated file paths. Default blank." stage="Attachments" /><input type="text" name="To" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default value is sender" stage="To" /><input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="CC" /><input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" stage="BCC" /><input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." stage="Subject" /></inputs><onsuccess>f9226d04-33db-4b85-a831-3e1200caa353</onsuccess></stage><stage stageid="f9226d04-33db-4b85-a831-3e1200caa353" name="Custom Reply" type="Code"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><loginhibit /><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Entry ID" expr="[Entry ID]" /><input type="text" name="Message" expr="[Message]" /><input type="text" name="Profile" expr="[Profile]" /><input type="text" name="Attachments" expr="[Attachments]" /><input type="text" name="To" expr="[To]" /><input type="text" name="CC" expr="[CC]" /><input type="text" name="BCC" expr="[BCC]" /><input type="text" name="Subject" expr="[Subject]" /></inputs><onsuccess>31caf02a-41b3-43a4-b2a2-a8dd383f44b5</onsuccess><code><![CDATA[Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)
Dim addressCount As Integer

Dim item = _nameSpace.GetItemFromID(Entry_ID)
Dim reply = item.Reply

If Subject <> "" Then
	reply.Subject = Subject
Else
	reply.Subject = item.Subject
End If

If [To] <> "" Then
	Dim toAddresses = Split([To], ";")
	
	reply.Recipients.Remove(1)

	For addressCount = LBound(toAddresses) To UBound(toAddresses)
		Dim recipient = reply.Recipients.Add(toAddresses(addressCount)) 
		recipient.Resolve  
		If recipient.Resolved Then recipient.Type = OlMailRecipientType.olTo
	Next 
	
End if

If CC <> "" Then
	Dim ccAddresses = Split([CC], ";")
	addressCount = 0
	For addressCount = LBound(ccAddresses) To UBound(ccAddresses)
	Dim recipient = reply.Recipients.Add(ccAddresses(addressCount))
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olCC 
	Next

End If

If BCC <> "" Then
	Dim bccAddresses = Split([BCC], ";")
	addressCount = 0
	For addressCount = LBound(bccAddresses) To UBound(bccAddresses)
	Dim recipient = reply.Recipients.Add(bccAddresses(addressCount))
	recipient.Resolve
	If recipient.Resolved Then recipient.Type = OlMailRecipientType.olBCC
	Next

End If

Dim sr As StringBuilder = New StringBuilder()
sr.Append("<HR>").Append("<P style='font-size: 11pt; font-family: Calibri'>").Append("<B>From:</B> " & item.SenderEmailAddress).Append("<BR><B>Sent:</B> " & item.SentOn.ToString()).Append("<BR><B>To:</B> " & item.To)

Dim ccAddrs As String = item.CC
If ccAddrs.Length > 0 Then
	sr.Append("<BR><B>CC:</B> " & ccAddrs)
End If

sr.Append("<BR><B>Subject:</B> " & item.Subject).Append("</P>").Append("<BR><BR>")

reply.HTMLBody = Message & sr.ToString() & item.HTMLBody

For Each att As String In Attachments.Split(";"c)
	If att = "" Then Continue For
	reply.Attachments.Add(att)
Next

reply.Send
]]></code></stage><stage stageid="d39abc75-6218-4268-87ee-77f2179164f8" name="Entry ID" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative>An ID obtained from one of the Get Item actions in this object.</narrative><displayx>-165</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f120bb8a-a841-4630-978f-8df6f133973a" name="Message" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8a75f953-c1cd-484f-b04c-54354d92ce38" name="Input" type="Block"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><loginhibit /><narrative></narrative><displayx>-240</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>270</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="c78d5a96-c1e7-430a-900f-2b276653f5cd" name="Profile" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9cb2c3b1-9ed9-4549-8575-7c45a18f6db4" name="Attachments" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0ddbaa7c-bd48-40d6-8bda-796e96edbcee" name="Subject" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>270</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3d19d354-5bd3-4169-be6d-3916da15466b" name="BCC" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>240</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7c0e5ad7-a858-42fb-9993-bc2094c30777" name="CC" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="84cefb34-2a49-4574-8c8f-40c62f8a5b19" name="To" type="Data"><subsheetid>c153f5f7-2453-4b1c-810b-a866e8561be4</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="76d6173b-49dd-4e6d-a971-80973de07426" name="Get Received Items (Customised)" type="SubSheetInfo"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative>Lists Inbox items matching the parameters provided</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f5ce35d7-f47f-4b83-ac6f-4ab0e4b39020" name="Item Count" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>270</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9d3d2213-24ec-47f9-9be8-4ffe738b595b" name="Internal_Get Items" type="SubSheet"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>420</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" expr="[Outlook Folder ID]" /><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." expr="[Sub Folder]" /><input type="text" name="Profile" narrative="The mail client profile to use" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs><onsuccess>507dbeb4-cf70-4807-a8db-ba296bbb0416</onsuccess><processid>e8eb24e1-c52b-45e6-80ba-9544055dab29</processid></stage><stage stageid="55bafe10-f0eb-483b-931d-ade0fe821115" name="Outlook Folder ID" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="15ea7ecb-ef98-419d-9ec8-36118efe00a9" name="Sub Folder" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="507dbeb4-cf70-4807-a8db-ba296bbb0416" name="End" type="End"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>480</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="9ea05039-1ef0-4b35-a3ce-99a03a26948c" name="Subject" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>240</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bf6cd3af-b412-47ab-a147-3e2cc3e88077" name="Start" type="Start"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Sender Name" narrative="Optional. The From display name, which might be a name (eg John Smith) or email address (eg admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the From field." stage="Sender Name" /><input type="text" name="Sender Email" narrative="Optional. The sender email address." stage="Sender Email" /><input type="datetime" name="Received Earliest" narrative="Optional. The earliest date to search from." stage="Received Earliest" /><input type="datetime" name="Received Latest" narrative="Optional. The latest date to search to." stage="Received Latest" /><input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." stage="Subject" /><input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" stage="Message" /><input type="flag" name="Include Read" narrative="Optional, default True" stage="Include Read" /><input type="flag" name="Include Unread" narrative="Optional, default True" stage="Include Unread" /><input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." stage="Sub Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>aa68324c-87f2-4a06-a260-2f690369f667</onsuccess></stage><stage stageid="d0356e9a-da89-4a0a-addb-fbdf301cdbe3" name="Received Earliest" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>240</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b9d0b437-39dc-4237-ad49-0111b2b61ce4" name="Received Latest" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>240</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a2a0afb7-683e-4264-9db5-d001a0c37208" name="Filter Expression" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="aa68324c-87f2-4a06-a260-2f690369f667" name="Sender Name?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sender Name]&lt;&gt;&quot;&quot;" /><ontrue>844f4b68-ada5-4911-ae9f-a862a220bb2f</ontrue><onfalse>1b49aca1-9b33-4994-84bb-ce1854d77ebb</onfalse></stage><stage stageid="844f4b68-ada5-4911-ae9f-a862a220bb2f" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>1b49aca1-9b33-4994-84bb-ce1854d77ebb</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:sendername LIKE '&quot;&amp;Replace([Sender Name], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="02eab7bf-cd33-48a4-a9b9-652af1c5b65a" name="Clean Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>330</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>43111650-ecc5-49b7-94dc-c2c350804301</onsuccess><calculation expression="Trim(Mid([Filter Expression], 6, Len([Filter Expression])))" stage="Filter Expression" /></stage><stage stageid="2c2de87d-0afe-4d9f-b605-ac83c43db28b" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>61fd89f7-a14b-4a86-ad80-ea733fdf298a</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:subject LIKE '&quot;&amp;Replace([Subject], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="bb1ddfe4-775a-49be-8ff8-6caa2a36681a" name="Subject?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Subject]&lt;&gt;&quot;&quot;" /><ontrue>2c2de87d-0afe-4d9f-b605-ac83c43db28b</ontrue><onfalse>61fd89f7-a14b-4a86-ad80-ea733fdf298a</onfalse></stage><stage stageid="1b49aca1-9b33-4994-84bb-ce1854d77ebb" name="Sender Email?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Sender Email]&lt;&gt;&quot;&quot;" /><ontrue>195be1b8-0a17-4bdc-9458-aa5a22bbe1ab</ontrue><onfalse>bb1ddfe4-775a-49be-8ff8-6caa2a36681a</onfalse></stage><stage stageid="195be1b8-0a17-4bdc-9458-aa5a22bbe1ab" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>bb1ddfe4-775a-49be-8ff8-6caa2a36681a</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:senderemail LIKE '&quot;&amp;Replace([Sender Email], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="3f2a2eab-a78b-42e6-864a-47999a5a97a2" name="Sender Name" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>240</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a801c0bc-7042-4caf-82d1-d8130146e9a1" name="Sender Email" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>240</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="43111650-ecc5-49b7-94dc-c2c350804301" name="Filter Expression?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Filter Expression]&lt;&gt;&quot;&quot;" /><ontrue>085a8e9f-3d55-4a6a-adba-a031626dc58a</ontrue><onfalse>9d3d2213-24ec-47f9-9be8-4ffe738b595b</onfalse></stage><stage stageid="085a8e9f-3d55-4a6a-adba-a031626dc58a" name="Prepend" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>9d3d2213-24ec-47f9-9be8-4ffe738b595b</onsuccess><calculation expression="&quot;@SQL=&quot;&amp;[Filter Expression]" stage="Filter Expression" /></stage><stage stageid="bb1fda34-9e1a-4c6e-81f1-90c3ad1072b9" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>02eab7bf-cd33-48a4-a9b9-652af1c5b65a</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:read=0&quot;" stage="Filter Expression" /></stage><stage stageid="b21d7f29-2de0-4f7c-ac79-e9529a0bd7e7" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>f30135a0-f6fd-4a9d-93ef-f233a01f8273</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&gt;='&quot; &amp; FormatDateTime([Received Earliest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="4da6f770-0afd-4c60-81ce-a9c11e97df90" name="Earliest?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Received Earliest])" /><ontrue>b21d7f29-2de0-4f7c-ac79-e9529a0bd7e7</ontrue><onfalse>f30135a0-f6fd-4a9d-93ef-f233a01f8273</onfalse></stage><stage stageid="f30135a0-f6fd-4a9d-93ef-f233a01f8273" name="Latest" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="IsDate([Received Latest])" /><ontrue>3db38b17-c11f-4925-a5b1-b5e0f555720e</ontrue><onfalse>1833e13f-17a9-41ae-9f6f-c67ba44e8856</onfalse></stage><stage stageid="3db38b17-c11f-4925-a5b1-b5e0f555720e" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>1833e13f-17a9-41ae-9f6f-c67ba44e8856</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:datereceived&lt;='&quot; &amp; FormatDateTime([Received Latest], &quot;dd MMMM yyyy HH:mm&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="f0feedef-a84a-471f-b2a7-4d78ffe5f728" name="Include Unread" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="5e3c7ad9-cd93-4145-96c3-10873237c77e" name="Include Read" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="1833e13f-17a9-41ae-9f6f-c67ba44e8856" name="Unread Only?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Include Unread]=True AND [Include Read]=False" /><ontrue>bb1fda34-9e1a-4c6e-81f1-90c3ad1072b9</ontrue><onfalse>f918baa5-8a9b-42c2-a5f6-f1d2b9f0fcc0</onfalse></stage><stage stageid="f918baa5-8a9b-42c2-a5f6-f1d2b9f0fcc0" name="Read Only?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Include Read]=True AND [Include Unread]=False" /><ontrue>cebb5bd0-5e2f-4760-985e-af8c62e5128e</ontrue><onfalse>f27475d4-33d8-4c12-b827-62405bed818f</onfalse></stage><stage stageid="cebb5bd0-5e2f-4760-985e-af8c62e5128e" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>f40fd5f3-ebc4-40bf-afd6-257506f05e01</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:read=1&quot;" stage="Filter Expression" /></stage><stage stageid="f27475d4-33d8-4c12-b827-62405bed818f" name="Anchor1" type="Anchor"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>225</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>563573b8-6d63-4485-ab82-1e2cb0cc217e</onsuccess></stage><stage stageid="563573b8-6d63-4485-ab82-1e2cb0cc217e" name="Anchor1" type="Anchor"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>330</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>f40fd5f3-ebc4-40bf-afd6-257506f05e01</onsuccess></stage><stage stageid="f40fd5f3-ebc4-40bf-afd6-257506f05e01" name="Anchor1" type="Anchor"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>330</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>02eab7bf-cd33-48a4-a9b9-652af1c5b65a</onsuccess></stage><stage stageid="5c8dbda6-9ccf-4797-84ef-52e31849b358" name="Items" type="Collection"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /><field name="AttachmentCount" type="text" namespace="" description="Number of attachments" /></collectioninfo></stage><stage stageid="fefe7517-30bb-4462-924e-3ab99c034625" name="Filter Expression" type="Calculation"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4da6f770-0afd-4c60-81ce-a9c11e97df90</onsuccess><calculation expression="[Filter Expression]&amp;&quot; AND urn:schemas:httpmail:textdescription LIKE '&quot;&amp;Replace([Message], &quot;*&quot;, &quot;%&quot;)&amp;&quot;'&quot;" stage="Filter Expression" /></stage><stage stageid="61fd89f7-a14b-4a86-ad80-ea733fdf298a" name="Message?" type="Decision"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Message]&lt;&gt;&quot;&quot;" /><ontrue>fefe7517-30bb-4462-924e-3ab99c034625</ontrue><onfalse>4da6f770-0afd-4c60-81ce-a9c11e97df90</onfalse></stage><stage stageid="78865903-cada-4bae-acb7-6ce3dd501cba" name="Message" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>240</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a21f2a20-4181-45b8-bc3c-395fed1129de" name="Input" type="Block"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="7c3f311f-1e8e-47b0-9bac-b05cdcf8b846" name="Output" type="Block"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="3229d9f6-eccd-466e-8f6c-4967c8e1493c" name="Profile" type="Data"><subsheetid>4e4717e2-7dd0-4780-aa24-d21846d7b2a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e4b8419b-a400-4aa0-ba83-2d868b9243af" name="Internal_Get Items - Customized" type="SubSheetInfo"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative>Sub function used by multiple actions within VBO. Do not change or publish.

Uses the Restrict method to create a filtered list of folder items. Not intended for publication.

</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="e54ca4ae-5db3-45d3-bc45-5eda53064f8e" name="Start" type="Start"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" stage="Filter Expression" /><input type="number" name="Outlook Folder ID" narrative="Mandatory. Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent" stage="Outlook Folder ID" /><input type="text" name="Sub Folder" narrative="Optional, default blank. The inbox sub folder to look in." stage="Sub Folder" /><input type="text" name="Profile" narrative="The mail client profile to use" stage="Profile" /></inputs><onsuccess>71384981-da9d-49fc-9c4a-8163bdc45589</onsuccess></stage><stage stageid="9471013f-2837-4120-baaa-a8051b22595c" name="End" type="End"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" /><output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" /></outputs></stage><stage stageid="71384981-da9d-49fc-9c4a-8163bdc45589" name="Get Items Customized" type="Code"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filter Expression" expr="[Filter Expression]" /><input type="number" name="Outlook Folder ID" expr="[Outlook Folder ID]" /><input type="text" name="Sub Folder" expr="[Sub Folder]" /><input type="text" name="Profile" expr="[Profile]" /></inputs><outputs><output type="collection" name="Items" stage="Items" /><output type="number" name="Item Count" stage="Item Count" /></outputs><onsuccess>9471013f-2837-4120-baaa-a8051b22595c</onsuccess><code><![CDATA[
Dim app = CreateObject("Outlook.Application")
Dim _nameSpace = app.GetNameSpace("MAPI")
_nameSpace.Logon(Profile)

Dim folder = _nameSpace.GetDefaultFolder(6)
If Outlook_Folder_ID = "-1" Then
	folder = folder.Parent
Else
	folder = _nameSpace.GetDefaultFolder(Outlook_Folder_ID)
End If

If Sub_Folder <> "" Then
	For each name as string in Sub_Folder.Split("\")
	folder = folder.Folders(name)
	Next
End If

'See https://msdn.microsoft.com/en-us/library/office/aa210946(v=office.11).aspx
'for mail item properties
Dim dataTable As New Data.DataTable
dataTable.Columns.Add("EntryID", Type.GetType("System.String"))
dataTable.Columns.Add("To", Type.GetType("System.String"))
dataTable.Columns.Add("CC", Type.GetType("System.String"))
dataTable.Columns.Add("Subject", Type.GetType("System.String"))
dataTable.Columns.Add("Body", Type.GetType("System.String"))
dataTable.Columns.Add("Attachments", Type.GetType("System.String"))
dataTable.Columns.Add("AttachmentCount", Type.GetType("System.String"))
dataTable.Columns.Add("ReceivedOn", Type.GetType("System.DateTime"))
dataTable.Columns.Add("SentOn", Type.GetType("System.DateTime"))
dataTable.Columns.Add("SenderName", Type.GetType("System.String"))
dataTable.Columns.Add("SenderEmailAddress", Type.GetType("System.String"))
dataTable.Columns.Add("Unread", Type.GetType("System.Boolean"))

Dim folderItems = If(Filter_Expression <> "", folder.Items.Restrict(Filter_Expression), folder.Items)

For Each item As Object In folderItems
	If Not TypeOf item Is MailItem Then Continue For
	Dim row As Data.DataRow = dataTable.NewRow
	row("EntryID") = item.EntryID
	row("To") = item.To
	row("CC") = item.CC
	row("Subject") = item.Subject
	row("Body") = item.Body
	
	Dim attachments As String = ""
	For Each attachment As Object In item.Attachments
        If attachment.Type = 1 Then
			attachments = attachments & "|" & attachment.DisplayName
		End If
	Next
	
	row("Attachments") = If (attachments.Length = 0, "", attachments.SubString(1))
	row("AttachmentCount") = item.Attachments.Count.ToString()
	row("SentOn") = item.SentOn
	row("ReceivedOn") = item.ReceivedTime
	row("SenderName") = item.SenderName
	row("SenderEmailAddress") = If (item.SenderEmailType = "EX",item.Sender.GetExchangeUser.PrimarySmtpAddress,item.SenderEmailAddress)
	row("Unread") = item.Unread
	dataTable.Rows.Add(row)
	Item_Count += 1
Next
Items = dataTable]]></code></stage><stage stageid="f2a162b3-2eee-42e3-8fd2-d9b82e576a37" name="Item Count" type="Data"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2a56bf59-153e-4542-97ae-7ddc47926410" name="Filter Expression" type="Data"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c4764ee8-4b2a-42a4-a9bf-94777900635e" name="Outlook Folder ID" type="Data"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative>Google OlDefaultFolders Enumeration, 6 = Inbox, 5 = Sent</narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="a77ddd6b-6108-480d-ad20-343f0121b180" name="Sub Folder" type="Data"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fa879dda-5150-4668-ac11-72d63f631928" name="Items" type="Collection"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="EntryID" type="text" namespace="" description="The mail ID. NB this is different from the Mapiex ID." /><field name="To" type="text" namespace="" description="The display name of the recipient(s)" /><field name="CC" type="text" namespace="" description="The display name of the copied recipient(s)" /><field name="Subject" type="text" namespace="" description="The mail subject line" /><field name="Body" type="text" namespace="" description="The mail message" /><field name="Attachments" type="text" namespace="" description="The names of the attachements as a CSV string" /><field name="ReceivedOn" type="datetime" namespace="" description="The date an incoming mail was received" /><field name="SentOn" type="datetime" namespace="" description="The date an outgoing mail was sent" /><field name="SenderName" type="text" namespace="" description="The display name of the sender" /><field name="SenderEmailAddress" type="text" namespace="" description="The email of the sender" /><field name="Unread" type="flag" namespace="" description="True if an incoming mail has not been read, otherwise False" /><field name="AttachmentCount" type="text" namespace="" description="Number of attachments" /></collectioninfo></stage><stage stageid="1de9b835-84d3-46f1-a8ea-d29f3d71ce67" name="Note2" type="Note"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><loginhibit /><narrative>NOT FOR PUBLICATION</narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="20" style="Regular" color="FF0000" /></stage><stage stageid="cbc5ab99-c1a7-4797-b9ca-51f612fced33" name="Input" type="Block"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f567e026-cb95-422c-8431-6b1f95a3af12" name="Output" type="Block"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="a6e4a9e0-55a6-4793-a9bf-6bfd6f347d93" name="Profile" type="Data"><subsheetid>e8eb24e1-c52b-45e6-80ba-9544055dab29</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage></process></object>
    </bpr:contents>
</bpr:release>